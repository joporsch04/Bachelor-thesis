% Convention: \\
% $\Psi$ wavefunction for the whole system  \\
% $\psi(\uvec{x})$ for a wavefunction in position space without choosing explicit coordinates, \\
% $\phi(\vec{P})$  for a wavefunction in momentum space, \\
% $\vec{A}$ for abstract vector as element in vector space, \\
% $\uvec{x}$ for vector in $\R^n$ \\
% $\ket{\Psi}$ an abstract element in Hilbert space $\Hc$, \\
% $\ket{\Phi}$ for the abstract Eigenstates of the whole Hamiltonian, \\
% $Y_{l, m}(\theta, \phi) = \braket{\theta, \phi | l, m}$ definition of spherical harmonics, \\
% $\psi_{n, l, m}(r, \theta, \phi)$ for the wavefunction of hydrogen in spherical coordinates, with $\uvec{x}=(r, \theta, \phi)$ \\
% I use underlined vectors when they are the coordinates and bold vectors when they are abstract elements in a vector space. \\
% Its the concept of a manifold. $\vec{A}$ could be in a manifold and not easy acessible but with a basis $\uvec{x}$ it has a physical meaning.\\
% The canonical momentum $\vec{P}$ parametrises the phase space but the kinetic momentum does not so kinetic momentum $\hat{=} \vec{p}$.\\
% The position and momentum operator are in boldface $\hat{\vec{x}}$ because they do not choose any kind of basis not even a representation in which they are displayed.\\
% When i use $\ket{\vec{k}}$ I mean a plane wave solution so "special" a continuum state.\\
% A $\cdot$ denotes a scalar product between two vectors, $\times$ is just normal multiplication. \\



The structure of this chapter largely follows \cite{Ivanov20012005}, with several modifications and adaptations to the context of this thesis.

The aim of this chapter is to derive an expression for the instantaneous ionization rate (IIR) by analytically solving the time-dependent Schrödinger equation (TDSE) within the framework of the strong-field approximation (SFA).



%%%%%%%%%%%%%%%%%%%%%
\section{Basic Formalism}
The goal is to describe the time evolution of a quantum system under an external, time-dependent electromagnetic field in a form suitable for the strong-field approximation.
To achieve this, a working formalism must be developed.
The starting point is the time-dependent Schrödinger equation for a given Hamiltonian and the Maxwell equations, from which the light-matter interaction can be derived.





%%%%%%%%%%%%%%%%%%%%%
\subsection{Schrödinger Equation}
The time evolution of a quantum system $\ket{\Psi(t)}$ is determined by the time-dependent Schrödinger equation, a partial differential equation that describes the relationship between the change in time of $\ket{\Psi(t)}$ with a general Hamiltonian $\Hs(t)$:
\begin{equation}
    i \hbar \frac{\partial}{\partial t} \ket{\Psi(t)} \stackrel{\mathrm{a.u.}}{=} i\frac{\partial}{\partial t} \ket{\Psi(t)} = \hat{\Hs}(t) \ket{\Psi(t)}. \label{eq:schroedinger}
\end{equation}
$\hat{\Hs}$ contains all relevant information for the time evolution, meaning it can be understood as being generated by the Hamiltonian.
The formal solution of \eqref{eq:schroedinger} depends on the time dependence of the Hamiltonian and the physical system under consideration.
In the general case where the Hamiltonian does not commute with itself at different times, the solution to \eqref{eq:schroedinger} can be written as a Dyson series:
\begin{equation}
    \ket{\Psi(t)} = \hat{\U}(t,t_0)\ket{\Psi(t_0)} = \hat{1} + \sum_{n=1}^{\infty} (-i)^n \int_{t_0}^{t} \dd t_1 \int_{t_0}^{t_1} \dd t_2 \cdots \int_{t_0}^{t_{n-1}} \dd t_n \hat{\Hs}(t_n) \hat{\Hs}(t_{n-1})\cdots\hat{\Hs}(t_1) \ket{\Psi(t_0)}. \label{eq:dyson}
\end{equation}





\paragraph{Physical setting}
This thesis focuses only on the ionization dynamics of a hydrogen atom exposed to an ultrashort and intense laser pulse.
The Coulomb potential in atomic units is given by
\begin{equation*}
    \hat{\Hs}_{\mathrm{C}} \stackrel{\mathrm{a.u.}}{=} \frac{1}{|\hat{\vec{r}}-\hat{\vec{r}}_0|}.
\end{equation*}
Since the TDSE is a \emph{linear} PDE, the Hamiltonian can be partitioned into separate parts.
This partitioning can be performed in various ways, all of which are mathematically equivalent.
For instance, a division into the unpertubed part and the interaction part yields:
\begin{equation*}
    \hat{\Hs}(t) \stackrel{\mathrm{a.u.}}{=} \underbrace{\frac{\hat{\vec{P}}^2}{2}+\frac{1}{|\hat{\vec{r}}-\hat{\vec{r}}_0|}}_{\hat{\Hs}_0} + \hat{\Hs}_{\mathrm{I}}(t).
\end{equation*}
Solving the TDSE with $\hat{\Hs}_0$ provides the bound states of the hydrogen atom.
The calculation can be found, for instance, in \cite{sakurai} and will not be discussed here.




%%%%%%%%%%%%%%%%%%%%%
\subsection{Light-Matter Interaction}
A light wave consists of an electric field $\vec{E}(\uvec{x},t)$ and a magnetic field $\vec{B}(\uvec{x},t)$, which propagate through vacuum at the speed of light. 
These fields are defined by Maxwell's equations in empty space:
\begin{equation*}
    \begin{aligned}
        \nabla \cdot \vec{E} &= 0 \quad & \nabla \times \vec{E} &= -\frac{\partial \vec{B}}{\partial t} \\
        \nabla \cdot \vec{B} &= 0 \quad & \nabla \times \vec{B} &= \mu_0\epsilon_0 \frac{\partial \vec{E}}{\partial t}
    \end{aligned}
\end{equation*}
These equations can be solved using the potentials
\begin{equation}
    \begin{aligned}
        \vec{E} &= -\nabla \varphi - \frac{\partial \vec{A}}{\partial t}, \\ \label{eq:potentials}
        \vec{B} &= \nabla \times \vec{A},
    \end{aligned}
\end{equation}
where $\vec{A}(\uvec{x}, t)$ is the vector potential and $\varphi(\uvec{x}, t)$ is the scalar potential. 
These potentials are not uniquely determined, as different choices can lead to the same physical fields. 
Specifically, the transformations
\begin{equation}
    \begin{aligned}
        \vec{A} &\to \vec{A} + \nabla \chi, \
        \varphi &\to \varphi - \frac{\partial \chi}{\partial t},
    \end{aligned}
\end{equation}
with $\chi(t)$ being an arbitrary smooth scalar function, also satisfy Maxwell's equations. 
This non-uniqueness is referred to as gauge freedom and arises directly from the structure of the equations. 
Selecting a particular gauge (i.e., fixing a certain $\chi$) can be just a matter of convenience and simplify calculations, as demonstrated below.






%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dipole Approximation}

The dipole approximation is a widely used simplification in light-matter interaction. 
It applies when the wavelength of the optical field is significantly larger than both the size of the relevant bound electron states and the maximum displacement of a free electron. 
Additionally, it assumes that the magnetic field of the light has a negligible effect on the electron dynamics, requiring nonrelativistic particle velocities.

To derive this approximation, we first express Maxwell’s equations in terms of the vector and scalar potentials, as defined in \eqref{eq:potentials}. 
This results in two coupled differential equations, which complicates the analysis. 
However, a simpler expression for the vector potential $\vec{A}$ can be obtained by selecting a specific gauge—the Lorentz gauge:
\begin{equation*}
    \partial_{\mu} \vec{A}^{\mu} = 0 \quad \text{or} \quad \nabla \cdot \vec{A} + \frac{\partial \varphi}{\partial t} = 0.
\end{equation*}
This gauge choice is achieved by solving the inhomogeneous wave equation for $\chi$, which arises in the explicit calculation and is feasible when $\vec{A}$ and $\varphi$ are known. With this gauge, Maxwell's equations decouple into:
\begin{equation*}
    \begin{aligned}
        \nabla^2 \varphi - \frac{\partial^2 \varphi}{\partial t^2} &= 0, \\
        \nabla^2 \vec{A} - \frac{\partial^2 \vec{A}}{\partial t^2} &= 0.
    \end{aligned}
\end{equation*}
The second equation is of particular interest, as it is a wave equation describing plane-wave solutions for $\vec{A}$:
\begin{equation*}
    \vec{A}(\uvec{x}, t) = \vec{A}_0 \e^{\pm i (\vec{k} \cdot \vec{r} - \omega t)}.
\end{equation*}
Mathematically, the dipole approximation corresponds to the leading-order term in the Taylor expansion of $\e^{i\vec{k} \cdot \vec{r}}$. 
Consequently, the vector potential becomes spatially independent and can be approximated as \cite{bosmandipoleapprox}:
\begin{equation*}
    \vec{A}(\uvec{x}, t) = \vec{A}_0\e^{\mp i \omega t}\mathrm{exp}\left\{\pm2\pi i\frac{|\vec{r}|}{\lambda}\vec{e}_{\vec{k}} \cdot \vec{e}_{\vec{r}}\right\} \approx \vec{A}_0 \e^{\mp i \omega t}\left(1+\Os\left(\frac{|\vec{r}|}{\lambda}\right)\right) = \vec{A}(t)
\end{equation*}
This approximation holds as long as the wavelength is sufficiently large. 
Under these conditions, the magnetic field simplifies to:
\begin{equation*}
    \vec{B} = \nabla \times \vec{A} \approx 0.
\end{equation*}
Although a different gauge may be chosen later, the physical description of the system remains unchanged. 
The dipole approximation itself is gauge-independent, ensuring that $\vec{B}$ remains approximately zero in any gauge. 
The Lorentz gauge is used here for convenience, as it provides an intuitive framework for the vector potential expansion.

The dipole approximation is valid for most experimental configurations, including the calculations in this work. 
However, it has limitations—for example, it breaks down in cases where strong-field ionization generates very fast electrons (\cite{bosmandipoleapprox}, \cite{breakdowndipoleapprox}).

This was the essence of the dipole approximation.
To further simplify the description of the laser field in the Hamiltonian, the choice of gauge must be considered more carefully.






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Length and velocity gauge}
Calculating ionization rates in strong-field physics presents challenges due to the choice of gauge. While gauge transformations do not alter physical reality in classical electrodynamics, they can affect the practical computation of formulas derived in this chapter, requiring careful consideration.

First, we derive two basic expressions for the Hamiltonian in the velocity gauge and length gauge using the dipole approximation. 
The semiclassical Hamilton function for a free electron in an electric field\footnote{Derivation can be found in \cite{LandauLifschitzBand2}} is:% what is with V(x), and the mass of the proton. is it in \vec{p}?
\begin{equation}%what are the arguments in H, is it even x? -> classical hamilton with H(P, x, t) but now quantum without because P is now nabla operator
    \hat{\Hs}(\uvec{x}, t) = \frac{1}{2m}(\vec{\hat{P}} - e \vec{A}(\uvec{x}, t))^2 - e \varphi(\uvec{x}, t) \label{eq:semiClassicalHamilton}
\end{equation}
Under the dipole approximation, this simplifies to:
\begin{equation*}
    \hat{\Hs}(\uvec{x}, t) = \frac{\vec{\hat{P}}^2}{2m} - \frac{e}{m}\vec{\hat{P}}\cdot \vec{A}(t) + \frac{e^2}{2m}\vec{A}^2(t) - e \varphi(\uvec{x}, t)
\end{equation*}
In most literature, $\varphi$ is set to zero at this stage of the derivation because the sources of the electromagnetic wave lie outside the region of interest.
While the dipole approximation does not strictly necessitate this assumption, $\varphi$ will be left as is.

A common assumption in semiclassical Hamiltonians is that the vector potential alone drives electron state transitions, with no back-reaction from the electron \cite{bosmandipoleapprox}. 
This approximation holds for sufficiently high laser intensities, though its validity may depend on specific conditions.%(is it really??) bosmann!!

Next, we perform a gauge transformation called length gauge via:
\begin{equation}
    \chi = -\vec{A}(t)\cdot \uvec{x}
\end{equation}
This transformation sets $\vec{A}$ to zero, modifying $\varphi$ as follows:%r=(x/3, y/3, z/3)
\begin{equation}
    \nabla \varphi \to \nabla \cdot (\varphi + \vec{x} \cdot \frac{\partial \vec{A}}{\partial t}) = \nabla \varphi + \frac{\partial \vec{A}}{\partial t} = - \vec{E}
\end{equation}
Integrating this equation from the origin to $\vec{x}$ yields the electric potential in the length gauge. %WHAT IS ALL THIS x AND r THING? DOES IT MAKE EVEN SENSE?
With $\vec{r}$ now quantized, the Hamiltonian becomes:
\begin{equation*}%i think E is still dependent on x so i cant just integrate it :( becasue phi is still dependent on x but i think i can solve it by just setting phi to zero
    \hat{\Hs}(\uvec{x}, t) = \frac{\hat{\vec{P}}^2}{2m} - e \hat{\vec{x}} \cdot \vec{E}%+ V(x)
\end{equation*}
The time-dependent part $\hat{\Hs}(t)$ of the Hamiltonian can be expressed as:
\begin{equation}
    \hat{\Hs}_{\mathrm{L}}(t) = -\hat{\vec{d}} \cdot \vec{E}(t) \label{eq:dipoleApprox}
\end{equation}
where $\hat{\vec{d}}=e\vec{\hat{x}}$ is the dipole operator and $\vec{E}(t)$ is the electric field.

An alternative gauge transformation, the velocity gauge, is also relevant. 
Using:
\begin{equation*}
    \chi = -\frac{e^2}{2m}\int_{-\infty}^{t} \vec{A}^2(t') \dd t'
\end{equation*}
the dipole approximation leaves $\vec{A}$ unchanged but modifies $\varphi$ as:
\begin{align*}
    \varphi &\to \varphi -\frac{e^2}{2m}\vec{A}^2(t)
\end{align*}
resulting in the Hamiltonian:
\begin{equation*}
    \hat{\Hs}(\uvec{x}, t) = \frac{\hat{\vec{P}}^2}{2m} -\frac{e}{m}\hat{\vec{P}} \cdot \vec{A}(t)
\end{equation*}
and
\begin{equation}
    \hat{\Hs}_{\mathrm{V}}(t) = -\frac{e}{m}\hat{\vec{P}} \cdot \vec{A}(t) \label{eq:dipoleApprox_velocity}
\end{equation}
where $\varphi$ is set to zero.

These are standard formulations of the interaction Hamiltonian for light-matter interactions. 
As with any gauge transformation, certain scenarios favor one gauge over another (see Chapter 4).



%breakdown of dipole approx-> for fast electrons also not only for small wavelengths!!!








%%%%%%%%%%%%%%%%%%%%%%
\section{Strong Field Formalism}

The difficulty with ionization arises from the existence of in some sense two Hilbert spaces: 
one for the bound states in the Hydrogen atom that accounts for distortion of the wavefunction due to the laser field, and another for the continuum states that are primarily affected by the laser field but also influenced by the binding potential.

It will be shown that SFA provides a treatment for the second Hilbert space, simplifying its description. 
However, previous SFA formulations oversimplify the first Hilbert subspace to such an extent that there remains one Hilbert space for eigenstates unaffected by the laser field and another for continuum states unaffected by the binding potential.

SFA, in principle, concerns only the second part; neglecting the dynamics before ionization is not truly part of it.
This section derives an expression that avoids excessive simplification of the first Hilbert space.
Additionally, it will be demonstrated that there are two equivalent ways of solving the TDSE, which later diverge when approximations are introduced.
Nevertheless, it becomes evident that these approaches nevertheless yield the same analytical result.









%%%%%%%%%%%%%%%%%%%%%
\subsection{Projection into Subspaces}
The full time-dependent Hamiltonian $\hat{\Hs}(t)$ is projected onto subspaces using projection operators defined by:
\begin{equation*}   
    \hat{X} = \sum_{n}\ket{\Psi_n}\bra{\Psi_n}\quad\text{and}\quad\hat{Y}= \hat{1} - \hat{X}
\end{equation*}
The use of projection operators for this type of problem is inspired by \cite{feshbachmethod}.
Projection operators are idempotent, i.e. $\hat{X}^2=\hat{X}$.
This property can be considered as the defining characteristic of projection operators, so applying them twice produces nothing new.

Here, $\ket{\Psi_n}$ represents the bound states of the atom. Using $\hat{X}+\hat{Y}=\hat{1}$, any partition of the Hamiltonian can be chosen.
The most natural partitioning is first written as:
\begin{equation*}
    \hat{\Hs}(t) = \underbrace{\hat{X}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}_{\mathrm{Bound}}(t)=\hat{\Hs}^{\mathrm{Sub}}_0(t)} + \underbrace{\hat{Y}\hat{\Hs}(t)\hat{Y} + \hat{X}\hat{\Hs}(t)\hat{Y} + \hat{Y}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}_{\mathrm{Cont}}(t)+\hat{\Hs}_{\mathrm{Rec}}(t)+\hat{\Hs}_{\mathrm{Ion}}(t)=\hat{\Hs}^{\mathrm{Sub}}_{\mathrm{I}}(t)} = \hat{\Hs}^{\mathrm{Sub}}_0(t)+\hat{\Hs}^{\mathrm{Sub}}_{\mathrm{I}}(t)
\end{equation*}
Similar to $\hat{\Hs}(t)=\hat{\Hs}_0(t)+\hat{\Hs}_\mathrm{I}(t)$, where $\hat{\Hs}_\mathrm{I}(t)$ represents the interacting perturbation (for instance, in the length gauge \eqref{eq:dipoleApprox}), but now applied to the full Hamiltonian projected onto subspaces.
For reasons that will be explained later, this is referred to as the Subspace partition.
While the notation may appear arbitrary now, its significance will become clear later.

The Hamiltonian can alternatively be partitioned into a different form, the full partition:
\begin{equation*}
    \hat{\Hs}(t) = \underbrace{\hat{X}\hat{\Hs}(t)\hat{X} + \hat{Y}\hat{\Hs}(t)\hat{Y} + \hat{X}\hat{\Hs}(t)\hat{Y}}_{\hat{\Hs}_{\mathrm{Bound}}(t)+\hat{\Hs}_{\mathrm{Cont}}(t)+\hat{\Hs}_{\mathrm{Rec}}(t)=\hat{\Hs}^{\mathrm{Full}}_0(t)} + \underbrace{\hat{Y}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}_{\mathrm{Ion}}(t) = \hat{\Hs}^{\mathrm{Full}}_{\mathrm{I}}(t)} = \hat{\Hs}^{\mathrm{Full}}_0(t)+\hat{\Hs}^{\mathrm{Full}}_{\mathrm{I}}(t)
\end{equation*}

The physical meaning of these terms can be interpreted as follows:
In $\hat{\Hs}_{\mathrm{Bound}}(t)$, the electron remains within the subspace and can always be described by a superposition of bound states.
Without ionization, this would be the only term governing the time evolution.
In previous work, this part of the Hamiltonian was often simplified to the extent that effects like Stark shift or coupling to excited states were neglected.

$\hat{\Hs}_{\mathrm{Cont}}(t)$ describes similar dynamics, but in the subspace of continuum states rather than bound states.
While in reality these two spaces cannot be completely separated, this distinction provides conceptual clarity.
This is the part where the SFA will later be applied.

The remaining terms describe different physical processes.
Two processes can occur: ionization of the electron or recombination with the atom.
These processes are governed by the terms $\hat{\Hs}_{\mathrm{Rec}}(t)$ and $\hat{\Hs}_{\mathrm{Ion}}(t)$.
In the present case, only one of these terms is relevant, and it will be shown later that $\hat{\Hs}_{\mathrm{Ion}}(t)$ is responsible for ionization, effectively "kicking" the electron out of the atom \cite{Ivanov20012005}.

While this approach may initially appear unnecessary, it establishes boundaries for the electron's behavior and provides useful intuition.










%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dyson equation}
For determining the time evolution, care must be taken since the full Hamiltonian does not commute with itself at different times, requiring an exact treatment.
As the full Dyson series \eqref{eq:dyson} can be cumbersome to deal with, an alternative approach is used.
This approach is enabled by the fact that the Hamiltonian can be split into two parts by projecting it into subspaces.
The ansatz chosen here is with the Dyson equation.
It relies on the time evolution operator and is completely equivalent to the TDSE and therefore to the Dyson series \eqref{eq:dyson}.
It can be written in two forms that are equivalent in their raw formulation but may yield different results when approximations such as SFA are introduced.\

The more intuitive form of the Dyson equation for this physical setting is given by:
\begin{equation}
    \hat{\U}(t,t_0)=\hat{\U}^{\mathrm{Sub}}_0(t,t_0)-i\int_{t_0}^{t} \hat{\U}(t,t')\hat{\Hs}^{\mathrm{Sub}}_{\mathrm{I}}(t')\hat{\U}^{\mathrm{Sub}}_0(t',t_0) \dd t'       \label{eq:dysonAnsatzODE}
\end{equation}
Note that the ``Sub'' propagators are not identical to the ``Full'' propagators \eqref{eq:dysonAnsatztRecX}, but within the Dyson ansatz, the full propagator $\hat{\U}$ remains unchanged.
This will change later when SFA is introduced.
Most formulas in this thesis can be best read from right to left, such as this one.
The time evolution starts with the Hamiltonian projected onto the bound states.
The interaction Hamiltonian then effectively ionizes the electron, inducing a transition to a virtual state, followed by propagation with the full time evolution. 
For more insights, refer to \cite{Ivanov20012005}.

The Dyson equation can also be expressed in a slightly different form:
\begin{equation}
    \hat{\U}(t,t_0)=\hat{\U}^{\mathrm{Full}}_0(t,t_0)-i\int_{t_0}^{t} \hat{\U}^{\mathrm{Full}}_0(t,t')\hat{\Hs}^{\mathrm{Full}}_{\mathrm{I}}(t')\hat{\U}(t',t_0) \dd t'       \label{eq:dysonAnsatztRecX}
\end{equation}
It can be verified that both equations satisfy the TDSE by direct substitution of $\hat{\U}(t,t_0)$.
The main difference between the ``Full'' and ``Sub'' formulations is that the "initial" propagator on the right side is now the full time propagator instead of a reduced one.
That motivates the acronym for both variants.

To simplify the analysis, the physical setting is further specified.
Starting from the ground state of the atom, the time evolution is given by $\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}$.
For additional simplification, a projection onto a continuum state $\ket{\Pi(t_{\mathrm{c}})}$ at time $t_{\mathrm{c}}$ is considered.
$\ket{\Pi(t_{\mathrm{c}})}$ does not represent a plane wave but rather an abstract state characterized by its momentum.
Naturally, there is no overlap between $\ket{\Pi(t_{\mathrm{c}})}$ and $\hat{\U}^{\mathrm{Sub}}_0(t,t_0)\ket{\Psi_0(t_0)}$ or with $\hat{\U}^{\mathrm{Full}}_0(t,t_0)\ket{\Psi_0(t_0)}$, as the electron has not yet been ionized and no initial population in the continuum is assumed \cite{Ivanov20012005}.
Furthermore, when $\hat{\Hs}^{\mathrm{Sub}}_{\mathrm{I}}(t')$ and $\hat{\Hs}^{\mathrm{Full}}_{\mathrm{I}}(t')$ are expanded, and the orthogonality of bound states and continuum states is taken into account, most terms of $\hat{\Hs}_{\mathrm{I}}(t')$ vanish.
The remaining expressions are:
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} \bra{\Pi(t_{\mathrm{c}})} \hat{\U}(t,t')\hat{Y}\hat{\Hs}(t')\hat{X} \hat{\U}^{\mathrm{Sub}}_0(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike1_withoutsfa}
\end{equation}
and
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} \bra{\Pi(t_{\mathrm{c}})} \hat{\U}^{\mathrm{Full}}_0(t,t')\hat{Y}\hat{\Hs}(t')\hat{X} \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike2_withoutsfa}
\end{equation}
Note: No approximations have been made; \eqref{eq:smatrixlike1_withoutsfa} and \eqref{eq:smatrixlike2_withoutsfa} are exact.













%%%%%%%%%%%%%%%%%%
\subsection{Strong Field Approximation}
In principle, the strong field approximation (SFA) involves neglecting the binding potential after ionization.
This approximation is intuitively reasonable because the laser field becomes the dominant force acting on the electron, exerting significantly greater influence on the ionization dynamics than the Coulomb potential.
It should be noted that SFA is not restricted to high-intensity laser pulses; even for arbitrary small ionization probabilities, SFA implies that once ionization occurs, the laser pulse dominates the subsequent dynamics.

First, the ``Sub'' partitioning must be addressed.
The time evolution operator after ionization can be expressed as:
\begin{equation*}
    %\hat{\Hs}(t) &= \hat{\Hs}_0 + \hat{V}_I(t) = \hat{\Hs}_p + \hat{V}_C + \hat{V}_I(t) 
    %e^{-i \int_{t'}^{t} \hat{\Hs}(t'') \dd t''} &\approx e^{-i \int_{t'}^{t} \hat{\Hs}_{\mathrm{SFA}}(t'') \dd t''} \quad \text{with} \quad \hat{\Hs}_{\mathrm{SFA}}(t) &= \hat{\Hs}(t) - \hat{V}_C
    \hat{\U}(t,t') \approx \hat{\U}_{\mathrm{SFA}}(t,t')=e^{-i \int_{t'}^{t} \hat{\Hs}_{\mathrm{SFA}}(t'') \dd t''} \quad \text{and} \quad \Hs_{\mathrm{SFA}}(t') = \hat{\Hs}(t) - \hat{\Hs}_{\mathrm{C}}      \label{eq:sfa_formula}
\end{equation*}
Similarly, for the ``Full'' partitioning:
\begin{equation*}
    \hat{\U}^{\mathrm{Full}}_0(t,t') \approx \hat{\U}_{\mathrm{SFA}}(t,t')=e^{-i \int_{t'}^{t} \hat{\Hs}_{\mathrm{SFA}}(t'') \dd t''} \quad \text{and} \quad \Hs_{\mathrm{SFA}}(t') = \hat{\Hs}(t) - \hat{\Hs}_{\mathrm{C}}      \label{eq:sfa_formula}
\end{equation*}
An exact expression for the SFA time evolution operator can be written, as it now commutes with itself at different times.

The SFA is particularly useful because the eigenstates of $\hat{H}_{\mathrm{SFA}}$ have an exact analytical solution: the Volkov states. 
To see this, consider the semiclassical Hamiltonian in \eqref{eq:semiClassicalHamilton}.

Classically, the physics driven by the momentum operator $\hat{\vec{P}}$ is known as the canonical momentum, given by:
\begin{equation}
    \frac{\partial \Ls}{\partial \dot{\uvec{x}}} = \vec{P} = m\uvec{\dot{x}} + \frac{e}{c}\vec{A} \stackrel{\mathrm{a.u.}}{=} \vec{p} + \vec{A}    \label{eq:canonicalMomentum}
\end{equation}
where $\mathcal{L}$ is the Lagrangian of the system.

In this case, the canonical momentum is conserved. 
To verify this, setting $\varphi=0$ (justified earlier) gives $\vec{E} = -\frac{\partial \vec{A}}{\partial t}$. 
The equation of motion for a charged particle in an electromagnetic field \cite{LandauLifschitzBand2} is:
\begin{equation*}
    \frac{\dd\vec{p}}{\dd t} = \vec{E} + \left(\uvec{\dot{x}}\times\vec{B}\right) \approx -\frac{\partial \vec{A}}{\partial t} = -\frac{\dd \vec{A}}{\dd t}   %why would i use uvec isntead of vec? doesnt make sense => with x its necessary because its natural variable of lagrandian
\end{equation*}
Thus, $\frac{\dd}{\dd t}\vec{P}=0$.

And also the energy of the system is clear:
\begin{equation}
    E(t) = \dot{\vec{x}}\frac{\partial \mathcal{L}}{\partial \dot{\vec{x}}}-\mathcal{L} = \frac{\vec{p}^2}{2} \label{eq:energy}
\end{equation}
Note that the energy is not conserved, as the previous argument holds only for the canonical momentum, not the kinetic momentum.

The key observation is that $\bra{\Pi(t_{\mathrm{c}})}$ (not $\bra{\vec{p}(t_{\mathrm{c}})}$!) is an eigenstate of $e^{-i \int_{t'}^{t} \hat{H}_{\mathrm{SFA}}(t'') \dd t''}$. 
Combining \eqref{eq:canonicalMomentum} and \eqref{eq:energy} yields:
\begin{equation*}
    \bra{\Pi(t_c)}e^{-i \int_{t'}^{t} \hat{\Hs}_{\mathrm{SFA}}(t'') \dd t''} = \bra{\Pi(t_c)}e^{-i \int_{t'}^{t} (\vec{p} + \vec{A}(t''))^2 \dd t''}
\end{equation*}
Here, $\vec{P}$ is time-independent, while $\vec{A}$ is not.
ATTENTION!!! WITH p+A or P-A what is it???

Using the conservation of canonical momentum, the momentum at other times can be calculated. 
Of particular interest is the asymptotic limit when the laser field vanishes:
\begin{equation*}
    \vec{P} = \vec{p}(t'') + \vec{A}(t'') = \vec{p}(t\rightarrow \infty) + \vec{A}(t\rightarrow \infty) = \vec{p}
\end{equation*}
Furthermore, $\ket{\Pi}$ represents now a plane wave solution\textcolor{red}{(how??)},
\begin{equation*}
    \ket{\Pi} = \ket{\vec{p}+\vec{A}}
\end{equation*}
Combining these results leads to the following expressions for both ``Full'' and ``Sub'':
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} e^{-i \int_{t'}^{t} (\vec{p} + \vec{A}(t''))^2 \dd t''}\bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\hat{X}\, \hat{\U}^{\mathrm{Sub}}_0(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike1}
\end{equation}
and
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} e^{-i \int_{t'}^{t} (\vec{p} + \vec{A}(t''))^2 \dd t''}\bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\hat{X}\, \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike2}
\end{equation}
Note that the SFA eliminates the difference in the left part of the integrand between ``Sub'' and ``Full'', making the two equations distinct. 
The final step introduces a new approximation for $\hat{\U}^{\mathrm{Sub}}_0(t',t_0)\ket{\Psi_0(t_0)}$ and $\hat{\U}(t',t_0)\ket{\Psi_0(t_0)}$.

\paragraph{Sub-Hilbertspace ansatz}
Regardless of the final form, the expression can be expanded in the bound states $\ket{\Psi_n}$.
This is clear by considering the defining equation of the time evolution operator and observing that any overlap of $\hat{\U}^{\mathrm{Sub}}_0(t',t_0)\ket{\Psi_0(t_0)}$ with a state outside the bound-state representation would cancel out due to $\hat{X}$.
With this consideration, an ansatz using the interaction picture can be formulated as:
\begin{equation*}
    \hat{\U}^{\mathrm{Sub}}_0(t',t_0)\ket{\Psi_0(t_0)} = \sum_{n}c_n(t')e^{-iE_nt'}\ket{\Psi_n}\footnote{Here, $E_n$ are the eigenenergies and not the electric field. If it would be the electric field it would be denoted as a vector or the component of the vector.}
\end{equation*}
The factors $e^{-iE_nt'}$ are factored out to avoid potential numerical issues arising from their rapid oscillations.

In theory, this ansatz is exact but relies on the implicit assumption that the Hilbert spaces can be easily separated.
Additionally, it assumes that the bound states remain unaffected by the laser field, which is not strictly true in reality.
However, this approximation can be justified by the low laser intensity and the resulting ionization probability not exceeding $0.01$.

\paragraph{Full Hilbertspace ansatz}
This case involves a more severe approximation.
The primary advantage is that only the time evolution up to the ionization moment $t'$ is required.
The same assumptions regarding laser intensity and ionization probability apply here, justifying the approximation of the time evolution as a superposition of bound states:
\begin{equation*}
    \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} = \sum_{n}c_n(t')e^{-iE_nt'}\ket{\Psi_n}
\end{equation*}

\bigskip

The key difference between the two ansatzes lies in the coefficients $c_n(t')$.
In the subspace approach, the coefficients are obtained by solving the TDSE within the subspace spanned by the bound states.
This approach effectively cuts off ionization, forcing the electron to the subspace regardless of laser intensity.
Implementing this leads to a system of ordinary differential equations for the coefficients, hence the name.
In contrast, the other approach is fundamentally different.
Here, the TDSE must be solved in the full Hilbert space, with the coefficients extracted at times $t'$.
In the atto/femtosecond regime, this demands substantial computational resources, as the electron exits the sub-Hilbert space during the process.
For these numerical simulations, a solver called tRecX (discussed in Chapter 3) was employed.

Unlike other literature (\cite{Theory_NPS}, \cite{Ivanov20012005}), this ansatz does not neglect transitions between bound states prior to ionization.
For example, the laser pulse may excite the electron without immediately ionizing it.
The coefficients are expected to capture all relevant dynamics within the hydrogen atom before ionization, including effects such as AC Stark shifts and ground-state distortion.

The final expression can now be presented.
By simplifying the dipole matrix element $\vec{d}_n(\vec{p}+\vec{A}) = \bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\ket{\Psi_n}$ between the bound state and the continuum state, the dipole approximation \eqref{eq:dipoleApprox} can be applied, yielding:
\begin{equation*}
    \braket{\Pi(t_{\mathrm{c}})|\Psi_n(t)} = -\frac{i}{2}\int_{t_0}^{t} e^{-i \int_{t'}^{t} (\vec{p} + A_z(t''))^2 \dd t''}E_z(t')\sum_{n}c_n(t)e^{-iE_nt'}\bra{\vec{p}+A_z}\hat{d}_z\ket{\Psi_n} \dd t'       \label{eq:smatrix}
\end{equation*}
Here, the electric field is polarized along the z-axis.
This equation corresponds to the strong-field S-matrix in the length gauge, as found in many papers \cite{Theory_NPS}, but with the distinction that excited states are not neglected.




%%%%%%%%%%%%%%%%%%%%
\section{\textcolor{red}{Ionization rates}}
What is a ionization rate and why do we want to have it?

A dilemma exists in the current approaches: while numerical simulations provide accurate ionization probabilities, they fail to yield ionization rates. 
Conversely, analytical calculations produce reliable ionization rates but incorrect probabilities (see GASFIR paper).

No experimental method has been developed to directly measure ionization rates - only ionization probabilities, which represent a quantum mechanical observable, can be measured.

When an electromagnetic field is present, projections onto bound/unbound states lead to non-physical gauge-dependent predictions [14]. % M. Yuan, P. Xin, T. Chu, H. Liu, Optics Express 2017,25, 19 23493
The tunneling time is imaginary, source??? % This comment/question can be kept as is












%%%%%%%%%%%%%%%%%%%%%
\subsection{Derivation of extended SFA Rate}
The derivation mainly follows \cite{Theory_NPS} with some modifications.
First, the ionization probability is expressed as the amplitude of projection of the wavefunction onto the continuum subspace.
The total ionization probability is obtained by integrating the ionization rate over the time domain.
Therefore, the SFA rate \eqref{eq:smatrix} can be written as:
\begin{align*}
    \lim_{t\to\infty}\braket{\Psi(t)|\int \dd^3 p \ket{p}\bra{p}\Psi(t)} = &\int_{-\infty}^{\infty} \Gamma_{\mathrm{SFA}}(t) \dd t \\ %= \int_{\R^3}\dd^3p \braket{\Psi_n(t)|\Pi(t_{\mathrm{c}})}\braket{\Pi(t_{\mathrm{c}})|\Psi_n(t)}\\ 
    = &\int \dd^3 p \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \dd t_1  \dd t_2 \, e^{\frac{i}{2}\int_{t_1}^{t_2}(\vec{p}+A_z(t''))^2\dd t''} E_z(t_1)E_z(t_2)\\
    &\times\left(\sum_{n}e^{iE_nt_1}c_n^*(t_1)d_{z,n}^*(\vec{p}+A_z(t_1))\right)\left(\sum_{n}e^{-iE_nt_2}c_n(t_2)d_{z,n}(\vec{p}+A_z(t_2))\right)
\end{align*}
By changing variables to $t=\frac{t_2+t_1}{2}$ and $T=\frac{t_2-t_1}{2}$ and using the fact that the laser pulse is polarized along the z-axis, the expression becomes:
\begin{align*}
    \Gamma_{\mathrm{SFA}}(t) &= \int \dd^3 p \int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{t-T}^{t+T}(\vec{p}+A_z(t''))^2\dd t''} E_z(t-T) E_z(t+T)\\
    &\times\left(\sum_{n}e^{i(t-T)E_n}c_n^*(t-T)d_{z,n}^*(\vec{p}+A_z(t-T))\right)\left(\sum_{n}e^{-i(t+T)E_n}c_n(t+T)d_{z,n}(\vec{p}+A_z(t+T))\right)\\
    &= \sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta_p\,\sin\theta_p \int_0^{2\pi}\dd \phi_p\int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{t-T}^{t+T}(\vec{p}+A_z(t''))^2\dd t''} e^{i(t-T)E_{n_1}-i(t+T)E_{n_2}}\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\vec{p}+A_z(t-T))d_{z,n_2}(\vec{p}+A_z(t+T))
\end{align*}
The integration variable is changed from $\vec{p}$ to $\vec{p}+\vec{A}$, and with $\vec{\Delta}(t') = \vec{A}(t+t') - \vec{A}(t)$, the expression becomes:
\begin{align*}
    &\sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta_p\,\sin\theta_p \int_0^{2\pi}\dd \phi_p\int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{-T}^{T}(\vec{p}+\Delta_z(t''))^2\dd t''} e^{i(t-T)E_{n_1}-i(t+T)E_{n_2}}\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\vec{p}+\Delta_z(-T))d_{z,n_2}(\vec{p}+\Delta_z(T))
\end{align*} 
Also the integrand in the exponential function can be further simplifyed:
\begin{align*}
    \frac{i}{2}\int_{-T}^{T}(\vec{p}+\Delta_z(t''))^2\dd t'' &= i\vec{p}^2T + \frac{i}{2}\int_{-T}^{T}\Delta_z(t'')^2+2\vec{p}\cdot\Delta_z(t'')\dd t'' \\
    &= i\vec{p}^2T + ip\cos\theta_p\int_{-T}^{T}\Delta_z(t'')\dd t'' +  \frac{i}{2}\int_{-T}^{T}\Delta_z(t'')^2\dd t''
\end{align*}
Following the notation used in the code as well as in \cite{Theory_NPS}, where
\begin{equation*}
    \vec{\bar{\Delta}}^k = \int_{-T}^{T}\vec{\Delta}^k(t')\dd t' = \int_{-T}^{T}\left(\vec{A}(t+t') - \vec{A}(t)\right)^k\dd t'
\end{equation*}
the final SFA rate to be implemented is given by:
\begin{align}
    \Gamma_{\mathrm{SFA}}(t) &= \sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta_p\,\sin\theta_p \int_0^{2\pi}\dd \phi_p\int_{-\infty}^{\infty} \dd T\\
    &\times \exp\left(i\vec{p}^2T + ip\cos\theta_p\bar{\Delta}_z^k +  \frac{i}{2}\bar{\Delta}_z^2  + i(t-T)E_{n_1}-i(t+T)E_{n_2}\right)\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\vec{p}+\Delta_z(-T))d_{z,n_2}(\vec{p}+\Delta_z(T))
    \label{eq:sfa_rate_improved}
\end{align}
For numerical calculations, it can be convenient to split a complex integrand into its phase and absolute value.
Although this is typically done with the given formula, the coefficients remain complex and may exhibit rapidly oscillating phase behavior.







%%%%%%%%%%%%%%%%%%%%%
\section{Strong Field Ionization}
This section mostly follows \cite{manorammasterthesis}.
While not directly necessary for this thesis, these terms are frequently encountered in the literature and are briefly mentioned here for completeness.
Ionization can occur in different ways, depending on the laser parameters and the atom or material used.
To distinguish these processes, several parameters must be defined.
According to \cite{Keldysh:1965ojf}, strong field ionization primarily depends on three parameters: the photon energy, the binding potential, and the ponderomotive energy.

\paragraph{Ponderomotive Energy}
The ponderomotive energy is defined as the cycle-averaged quiver energy of a free electron in an electromagnetic field [cite wikipedia].
Since harmonic motion is experienced by the particle, the time-averaged kinetic energy is given by
\begin{equation*}
    \frac{1}{2}m\omega^2 \braket{x^2}=\frac{e^2E^2}{4m_e\omega^2} = \frac{E^2}{4\omega^2}
\end{equation*}

\paragraph{Keldysh Parameter}
The Keldysh parameter $\gamma$ compares the ponderomotive energy with the ionization potential.
It is defined as
\begin{equation*}
    \gamma = \sqrt{\frac{I_p}{2U_p}}
\end{equation*}
The ionization potential in the hydrogen atom is $I_p = 13.6\mathrm{eV} = 0.5 \mathrm{au.}$
Different regimes of ionization, each with distinct physical interpretations, can be defined based on the value of the Keldysh parameter.

%how much should i write about these kind of things???
\subsection{Tunneling Ionization}
This regime is typically characterized by $\gamma \ll 1$.
Here, the laser pulse is sufficiently strong to distort the potential barrier.
Alternatively, the tunneling regime can be defined as the regime where the quasi-static approximation holds, meaning the instantaneous ionization rate is entirely determined by the absolute value of the electric field at that time \cite{manorammasterthesis}.
This allows the ionization rate for DC and AC fields in this regime to be calculated analytically \cite{tunnel_ion_complexatoms}.
\begin{equation*}
    \Gamma_{\mathrm{SFA}}(t) \propto \exp\left(-\frac{2}{3}\frac{(2I_p)^{3/2}}{F}\right)
\end{equation*}
Here, $F$ represents the peak of the electric field for an AC field.

\subsection{Multiphoton Ionization}
The regime where $\gamma \gg 1$ is commonly referred to as multiphoton ionization.
This occurs when the field strength is significantly weaker than in the tunneling regime.
In other words, the multiphoton regime can be defined as the regime where
\begin{equation*}
    \Gamma_{\mathrm{SFA}}(t) \propto \vec{E}^{2N} \quad \text{with} \quad N = \frac{I_p}{E_e}
\end{equation*}
holds \cite{Ivanov20012005}.
This process can be visualized as the electron gaining energy while remaining under the barrier, effectively being heated up.
Unlike the tunneling regime, this process is non-adiabatic.
For further details, refer to \cite{Ivanov20012005} and \cite{Keldysh:1965ojf}.

\subsection{Intermediate Regime}
This regime is particularly relevant for this thesis.
The previous regimes describe limiting cases where the complementary process is negligible.
However, in reality, a coexistence of both processes often occurs.
In the intermediate regime, the tunneling process is no longer adiabatic.
The potential barrier undergoes significant oscillations during the electron's tunneling time, allowing energy to be absorbed from the laser field while tunneling takes place.