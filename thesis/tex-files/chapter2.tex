% Convention: \\
% $\Psi$ wavefunction for the whole system  \\
% $\psi(\uvec{x})$ for a wavefunction in position space without choosing explicit coordinates, \\
% $\phi(\uvec{p})$  for a wavefunction in momentum space, \\
% $\vec{A}$ for abstract vector as element in vector space, \\
% $\uvec{x}$ for vector in $\R^n$ \\
% $\ket{\Psi}$ an abstract element in Hilbert space $\Hc$, \\
% $\ket{\Phi}$ for the abstract Eigenstates of the whole Hamiltonian, \\
% $Y_{l, m}(\theta, \phi) = \braket{\theta, \phi | l, m}$ definition of spherical harmonics, \\
% $\psi_{n, l, m}(r, \theta, \phi)$ for the wavefunction of hydrogen in spherical coordinates, with $\uvec{x}=(r, \theta, \phi)$ \\
% I use underlined vectors when they are the coordinates and bold vectors when they are abstract elements in a vector space. \\
% Its the concept of a manifold. $\vec{A}$ could be in a manifold and not easy acessible but with a basis $\uvec{x}$ it has a physical meaning.\\
% The canonical momentum $\uvec{P}$ parametrises the phase space but the kinetic momentum does not so kinetic momentum $\hat{=} \vec{p}$.\\
% The position and momentum operator are in boldface $\hat{\vec{x}}$ because they do not choose any kind of basis not even a representation in which they are displayed.\\
% When i use $\ket{\vec{k}}$ I mean a plane wave solution so "special" a continuum state.\\
% A $\cdot$ denotes a scalar product between two vectors, $\times$ is just normal multiplication. \\


The strucutre in this chapter mainly follows \cite{Ivanov20012005} with some modifications.

What im going to do in this chapter: derive an instantanious ionization rate (IIR) by solving time dependent schroedinger equation (TDSE) using the strong field approximation (SFA) and the interaction picture.
First I solve the TDSE without making any (strict/harsh) approximations and piece by piece establish our physical setting (hydrogen atom with external laser field, in multiphoton ionisation regime, ionpropability around 0.01%)


%%%%%%%%%%%%%%%%%%%%%
\section{Basic Formalism}
Our goal is to come up with a expression were we can use the strong field approximation effectively.
We want the time evolution of a quantum system in the presence of an external time dependent field in order to describe the strong field ionization later on.
For that we first need to solve the schroedinger equation for a given Hamiltonian.\\
We will come across some difficulties like gauge dependence.

\subsection{Schrödinger Equation}
The time evolution of a quantum system is given by the time dependent Schrödinger equation and a general hamiltonian
\begin{equation}
    i \frac{\partial}{\partial t} \ket{\Psi(t)} = \hat{\Hs}(t) \ket{\Psi(t)}. \label{eq:schroedinger}
\end{equation}
The formal solution depends on the time dependence of the hamiltonian and the physical setting. 
With no further assumptions about our Hamiltonian becasue $[\hat{\Hs}(t), \hat{\Hs}(t')] \neq 0$ we can write the formal solution to \eqref{eq:schroedinger} as a Dyson series:
The solution is then given by 
\begin{equation}
    \ket{\Psi(t)} = \hat{\U}(t,t_0)\ket{\Psi(t_0)} = \hat{\vec{1}} + \sum_{n=1}^{\infty} (-i)^n \int_{t_0}^{t} \dd t_1 \int_{t_0}^{t_1} \dd t_2 \cdots \int_{t_0}^{t_{n-1}} \dd t_n \hat{\Hs}(t_n) \hat{\Hs}(t_{n-1})\cdots\hat{\Hs}(t_1) \ket{\Psi(0)}. \label{eq:dyson}
\end{equation}
Since the time evolution depends mainly on the Hamiltonian, one could say the time evolution is generated by the Hamiltonian.
% Now its time so establish a physical setting. We have Hydrogen Atom with nucleus and electron described by time indepentent Hamilton $\hat{\Hs}_0$. 
% The external laser Field is described by an time dependent part $\hat{V}(t)$. To describe the interaction of the atom with the laser field we use in the following the dipole approximation.\\
% There are two ways of representing $\ket{\Psi(t)}$, schroedinger and interaction picture. Coefficients.





%%%%%%%%%%%%%%%%%%%%%
%\newpage
\subsection{Light-Matter Interaction}
A light wave is defined by the Maxwell equations
\begin{equation*}
    \begin{aligned}
        \nabla \cdot \vec{E} &= \rho \quad & \nabla \times \vec{E} &= -\frac{\partial \vec{B}}{\partial t} \\
        \nabla \cdot \vec{B} &= 0 \quad & \nabla \times \vec{B} &= \vec{J} + \frac{\partial \vec{E}}{\partial t}
    \end{aligned}
\end{equation*}
The Maxwell equations are being solved by
\begin{equation}
    \begin{aligned}
        \vec{E} &= -\nabla \varphi - \frac{\partial \vec{A}}{\partial t}\\ \label{eq:potentials}
        \vec{B} &= \nabla \times \vec{A}
    \end{aligned}
\end{equation}
For these solutions we introduced the vector potential $\vec{A}(\uvec{x}, t)$ and the scalar potential $\varphi(\uvec{x}, t)$. 
These are not unique such that different choices can result in the same physical setting. In general
\begin{equation*}
    \begin{aligned}
        \vec{A} &\to \vec{A} + \nabla \chi \\
        \varphi &\to \varphi - \frac{\partial \chi }{\partial t}   
    \end{aligned}
\end{equation*}
also fulfill the Maxwell equations while $\chi(t)$ is an arbitrary smooth scalar function. The arbitrariness of $\chi$ is known as gauge freedom and a direct consequence of the Maxwell equations.
Choosing a gauge (i.e., a specific $\chi$) is a matter of convenience and can be used to simplify the calculations as presented in the following.








%%%%%%%%%%%%%%%%%%%%%
\subsection{Dipole Approximation}
Very important approximation. 
The dipole approximation is valid when the wavelength of the optical field is much larger than both the size of the relevant bound electron states and the maximum displacement of a free electron during the light-matter interaction. 
Additionally, it assumes that the magnetic field of the light has a negligible effect on the electron's motion, meaning the velocities of the charged particles must be nonrelativistic. \\
To see where exaclty one makes this assumption, first we rewrite the Maxwell equations in the dependence of the vector potential and the scalar potential as defined in \eqref{eq:potentials}. 
This will result in two coupled differential equations, what does not bring us any further. 
However we are interestet in making a simple expression for the vector potential $\vec{A}$.
We achieve this by choosing a certain gauge, the so called Lorentz gauge
\begin{equation*}
    \partial_{\mu} \vec{A}^{\mu} = 0 \quad \text{or} \quad \nabla \cdot \vec{A} + \frac{\partial \varphi}{\partial t} = 0
\end{equation*}
This can be achieved by solving the inhomogenous wave equation for $\chi$ that comes up when doing this calculation explicitly and is possible when $\vec{A}$ and $\varphi$ are know.
Now the Maxwell equations are uncoupled and can be written as
\begin{equation*}
    \begin{aligned}
        \nabla^2 \varphi - \frac{\partial^2 \varphi}{\partial t^2} &= \rho \\
        \nabla^2 \vec{A} - \frac{\partial^2 \vec{A}}{\partial t^2} &= \vec{J} 
    \end{aligned}
\end{equation*}
We are mainly interested in the second equation. The equation is known as the wave equation therefore $\vec{A}$ describes plane waves
\begin{equation*}
    \vec{A}(\uvec{x}, t) = \vec{A}_0 \e^{\pm i (\uvec{k} \cdot \uvec{x} - \omega t)}
\end{equation*}
The dipole approximation is mathemaically speaking just the leading term in Taylor expansion of $\e^{i\uvec{k} \cdot \uvec{x}}$. 
The vector potential is therefore independent of the spatial coordinates and can be written as \cite{bosmandipoleapprox}:
\begin{equation*}
    \vec{A}(\uvec{x}, t) = \vec{A}_0\e^{\mp i \omega t}\mathrm{exp}\left\{\pm2\pi i\frac{|\uvec{x}|}{\lambda}\uvec{e}_k \cdot \uvec{e}_x\right\} \approx \vec{A}_0 \e^{\mp i \omega t}\left(1+\Os\left(\frac{|\uvec{x}|}{\lambda}\right)\right) = \vec{A}(t)
\end{equation*}
As long as the Wavelength is big enough this approximation is valid. It follows:
\begin{equation*}
    \vec{B} = \nabla \times \vec{A} \approx 0
\end{equation*}
Even tough we will later choose another gauge, the physics in our system remains the same. The dipole Approximation is not gauge dependent, so in another gauge $\vec{B}$ remains approximately zero.
Choosing the lorentz gauge here is just a matter of convenience, because just expanding the vector potential to the linear term is very intuitive. 

The dipole approximation holds well for most experimental setups and also for the calculations in this thesis.
Nonetheless it has its limits for instance when very fast electrons are generated by strong field ionization it causes a breakdown of the dipole approximation (\cite{bosmandipoleapprox}, \cite{breakdowndipoleapprox}).

This was the essence of the dipole approximation but we also want a intuitive expression for our Laser Fild in the Hamiltonian. 
For that we need to think more about the gauge of our system.






%%%%%%%%%%%%%%%%%%%%%
\subsection{Gauges}
What makes calculating ionisation rates in strong field physiccs so difficult is the gauge, ie deciding which one you want to choose and when. \\
First, I will derive two basic expressions for the Hamiltonian in the so called velocity gauge and length gauge using the dipole approximation.
It will be helpfull to look at the semi classical Hamilton function of a free electron in an electric field\footnote{Derivation can be found in \cite{LandauLifschitzBand2}}: % what is with V(x), and the mass of the proton. is it in \vec{p}?
\begin{equation} %what are the arguments in H, is it even x? -> classical hamilton with H(P, x, t) but now quantum without because P is now nabla operator
    \hat{\Hs}(\uvec{x}, t) = \frac{1}{2m}(\vec{\hat{P}} - e \vec{A}(\uvec{x}, t))^2 - e \varphi(\uvec{x}, t)  \label{eq:semiClassicalHamilton}    %+ V(x)
\end{equation}
In the dipole Approximation, this can be simplified to:
\begin{equation*}
    \hat{\Hs}(\uvec{x}, t) = \frac{\vec{\hat{P}}^2}{2m} - \frac{e}{m}\vec{\hat{P}}\cdot \vec{A}(t) + \frac{e^2}{2m}\vec{A}^2(t) - e \varphi(\uvec{x}, t) %+ V(x)
\end{equation*}
Note that we could set $\varphi$ to zero because the source of the em wave are outside of our region of interest but the dipole approximation can be made without this assumption. 
We will however set $\varphi$ to zero later. 
Another general assumption one made when working with semi classical Hamiltonians is that only the vectorpotential causes the electron to change its state but not vice versa (Bosßmann). 
This is reasonable approximation because in our case the intensity of the Laser is sufficiently high, so we dont have to worry about that(is it really??).
Now we perform our desired gauge transformation, called length gauge via:
\begin{equation*}
    \chi = -\vec{A}(t)\cdot \uvec{x} %r=(x/3, y/3, z/3)
\end{equation*}
This gauge sets $\vec{A}$ to zero, and $\varphi$ will have the following form:
\begin{equation*}
    \nabla \varphi \to \nabla \cdot (\varphi + \vec{x} \cdot \frac{\partial \vec{A}}{\partial t}) = \nabla \varphi + \frac{\partial \vec{A}}{\partial t} = - \vec{E}
\end{equation*}%i think E is still dependent on x so i cant just integrate it :( becasue phi is still dependent on x but i think i can solve it by just setting phi to zero
Integrating this equation from the origin to $\vec{x}$ gives us the electric potential in the length gauge. Furthermore, $\vec{r}$ is now quantized and our Hamilton therefore reads:
\begin{equation*}
    \hat{\Hs}(\uvec{x}, t) = \frac{\hat{\vec{P}}^2}{2m} - e \hat{\vec{x}} \cdot \vec{E} %+ V(x)
\end{equation*}
We can rewirte the time dependent part $\hat{V}$ of our quantum mechanical Hamiltonian as
\begin{equation}
    \hat{\Hs}_{\mathrm{L}}(t) = -\hat{\vec{d}} \cdot \vec{E}(t) \label{eq:dipoleApprox}
\end{equation}
where $\hat{\vec{d}}=e\vec{\hat{x}}$ is the dipole operator and $\vec{E}(t)$ is the electric field.

However, there is a different gauge transfomation that will also be used in the context of this thesis.
Using the velocity transformation
\begin{equation*}
    \chi = -\frac{e^2}{2m}\int_{-\infty}^{t} \vec{A}^2(t') \dd t'
\end{equation*}
and because of the dipole approximation, it leaves $\vec{A}$ unchanged but $\varphi$ changes as 
\begin{align*}
    \varphi &\to \varphi -\frac{e^2}{2m}\vec{A}^2(t) 
\end{align*}
resulting in the following Hamiltonian:
\begin{equation*}
    \hat{\Hs}(\uvec{x}, t) = \frac{\hat{\vec{P}}^2}{2m} -\frac{e}{m}\hat{\vec{P}} \cdot \vec{A}(t)
\end{equation*}
and
\begin{equation}
    \hat{\Hs}_{\mathrm{V}}(t) = -\frac{e}{m}\hat{\vec{P}} \cdot \vec{A}(t) \label{eq:dipoleApprox_velocity}
\end{equation}
where $\varphi$ is set to zero.
These are common ways to write the interaction Hamiltonian for light matter interaction.
As with any kind of gauge transformation there are scenarios where one gauge is more convenient than the other (chapter 4).

%breakdown of dipole approx-> for fast electrons also not only for small wavelengths!!!









%%%%%%%%%%%%%%%%%%%
\newpage
\section{Strong Field Approximation}
%clear defintition of the strong field approximation, and the assumptions that are made.
The difficulty with ionisation arises because we now have in some sense two Hilbert spaces, one for the states in the Hydrogen atom that deals with some distortion of the wavefunction because of the Laser field and one for the continuum states that are affected mainly by the Laser field but also by the binding potential.\\
We will see SFA will take care about the second Hilbertspace and make it easier.  
However, previous SFA's simpifies the first Hilbertsubspace so much that there is just one hilbertspace for the eigenstates unaffectet by the laser field and one hilbertspace for the continuum states that are unaffectet by the binding potential.\\\\
SFA is in principle just the second part, neglecting the dynamics even bevore ionization is not really a part of it.
In this section I derive an expression that does not simplify the first Hilbert space to some extend.
However we will also see that there are two equivalent ways of solving the TDSE that that later differ when approximations are made. 
Nonetheless it becomes clear that in the end they "come together" again and yield the same analytical result.










%%%%%%%%%%%%%%%%%%%%%
\subsection{Subspaces}
First we project the full timedependent Hamiltonian $\hat{\Hs}(t)$ onto subspaces using projection operators defined by:
\begin{equation*}
    \hat{X} = \sum_{n}\ket{\Psi_n}\bra{\Psi_n}\quad\text{and}\quad\hat{Y}= \hat{1} - \hat{X}
\end{equation*}
The idea for using projecting operators for this kind of problem comes from this \cite{feshbachmethod}.
Projection operators are indempotent, i.e $\hat{X}^2=\hat{\vec{1}}$ so they are its own inverse.
This can be seen as the defining property of projecting operators so applying it twice makes no difference.

With $\ket{\Psi_n}$ being the bound states of our atom. Using $\hat{X}+\hat{Y}=\hat{1}$ we are free to choose any partition of the Hamiltonian we can think of.
First lets write the most natural partitioning::
\begin{equation*}
    \hat{\Hs}(t) = \underbrace{\hat{X}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}^{\mathrm{XX}}(t)=\hat{\Hs}^{\mathrm{ODE}}_0(t)} + \underbrace{\hat{Y}\hat{\Hs}(t)\hat{Y} + \hat{X}\hat{\Hs}(t)\hat{Y} + \hat{Y}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}^{\mathrm{YY}}(t)+\hat{\Hs}^{\mathrm{XY}}(t)+\hat{\Hs}^{\mathrm{YX}}(t)=\hat{\Hs}^{\mathrm{ODE}}_{\mathrm{I}}(t)} = \hat{\Hs}^{\mathrm{ODE}}_0(t)+\hat{\Hs}^{\mathrm{ODE}}_{\mathrm{I}}(t)
\end{equation*}
Just like with $\hat{Hs}(t)=\hat{\Hs}_0(t)+\hat{\Hs}_\mathrm{I}(t)$ where $\hat{\Hs}_\mathrm{I}(t)$ is the interacting pertubation like part for instance in length gauge \eqref{eq:dipoleApprox}, now just with the full hamiltonian and projecting onto supspaces. 
For reasons elaborated later I will call this the ODE partition. 
ODE stands for Ordinary Differential Equation and it will be used later to solve for the coefficients that weights our wavefunction.
Now the notation falls from the sky but later it will make sense.\\
However the Hamiltonian can also be partitioned into a different form:
\begin{equation*}
    \hat{\Hs}(t) = \underbrace{\hat{X}\hat{\Hs}(t)\hat{X} + \hat{Y}\hat{\Hs}(t)\hat{Y} + \hat{X}\hat{\Hs}(t)\hat{Y}}_{\hat{\Hs}^{\mathrm{XX}}(t)+\hat{\Hs}^{\mathrm{YY}}(t)+\hat{\Hs}^{\mathrm{XY}}(t)=\hat{\Hs}^{\mathrm{tRecX}}_0(t)} + \underbrace{\hat{Y}\hat{\Hs}(t)\hat{X}}_{\hat{\Hs}^{\mathrm{YX}}(t) = \hat{\Hs}^{\mathrm{tRecX}}_{\mathrm{I}}(t)} = \hat{\Hs}^{\mathrm{tRecX}}_0(t)+\hat{\Hs}^{\mathrm{tRecX}}_{\mathrm{I}}(t)
\end{equation*}
Lets think about what these terms mean specifcially. 
In $\hat{\Hs}^{\mathrm{XX}}(t)$ the electron never leaves the space an can always be described by a superposition of the bound states.
If there would be no ionization this would be the only part determining the time evolution.
In previos work this part of the Hamiltonian was suimplified so much that effects lake stark shift or coupling to excited states were neglected.
But in principle $\hat{\Hs}^{\mathrm{XX}}(t)$ is were the approximations that are not part of SFA are being made.\\\\
$\hat{\Hs}^{\mathrm{YY}}(t)$ is basically the same but not in the subspace covered by the bound states, rather the continuum states.
In reality you can not really seperate these two spaces but this is only to get a better view of it.
This is the part where the SFA is being made later.\\\\
Lets think about the other terms. 
There are two processes that can happen, the electron can get ionized or it can recombine with the atom.
These processes are governed by the terms $\hat{\Hs}^{\mathrm{XY}}(t)$ and $\hat{\Hs}^{\mathrm{YX}}(t)$.
Of course in our case only one of the terms is relevant and further we will later see that $\hat{\Hs}^{\mathrm{YX}}(t)$ "cause" the ionization in the sense that it "kicks" the electron out of the atom \cite{Ivanov20012005}.\\\\

For now this seems to a very useless thing to do, but it sets the boundarys for what the electron is going to do and builds some intuition for that.





%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dyson equation}
For determining the time evolution we need to be carefull since the whole Hamiltonian doesnt commutate with itself at different times so we need to be exact. 
Since the full Dyson series \eqref{eq:dyson} can be cumbersome to deal with, we choose a different way. 
What helps us is the fact that we can split the Hamiltonian by projecting it into subspaces in two parts. 
The ansatz choosen here is called dyson equation. 
It relies on the time evolution operator and is completely equaivalent to the TDSE and therefore the dyson series \eqref{eq:dyson}.
It can be written in two ways that are in its raw form equivalent to each other but when approximations such as SFA are made, it may yield different results.\\

Lets write the in my opinion more inutitive form of the dyson equation for this physical setting:
\begin{equation}
    \hat{\U}(t,t_0)=\hat{\U}^{\mathrm{ODE}}_0(t,t_0)-i\int_{t_0}^{t} \hat{\U}(t,t')\hat{\Hs}^{\mathrm{ODE}}_{\mathrm{I}}(t')\hat{\U}^{\mathrm{ODE}}_0(t',t_0) \dd t'       \label{eq:dysonAnsatz}
\end{equation}
Note that the ODE propagators are of course not the same as the tRecX propagators but within the dyson ansatz the full propagator $\hat{\U}$ remains the same.
But this will change later when SFA comes into play.
Most of the formulas in this thesis can be best read from right to left such as this one.
It starts with the time evolution generated by the Hamiltonian projected onto the bound states. 
I find this intuitive since the initial state before the laser hits the atom is the ground state.\\

Furthermore we can also write the dyson equation in a slightly different form:
\begin{equation}
    \hat{\U}(t,t_0)=\hat{\U}^{\mathrm{tRecX}}_0(t,t_0)-i\int_{t_0}^{t} \hat{\U}^{\mathrm{tRecX}}_0(t,t')\hat{\Hs}^{\mathrm{tRecX}}_{\mathrm{I}}(t')\hat{\U}(t',t_0) \dd t'       \label{eq:dysonAnsatz}
\end{equation}
It can be eaily checked that both equations indeed satisfy the TDSE by simple plugging in $\hat{\U}(t,t_0)$.
The main differences between tRecX and ODE is that the "initial" propagator on the right side is now the full time proopagator instead of a part of it.\\

To make things easier we concretize the physical setting. 
Starting with the ground state of the atom so the time evolution is given by $\hat{\U}(t,t_0)\ket{\Psi_0(t_0)}$.
To make things even simpler, we project onto a continuum state $\ket{\Pi(t_{\mathrm{c}})}$ at time $t_{\mathrm{c}}$.
$\ket{\Pi(t_{\mathrm{c}})}$ does not represent a plane wave, it is more an abstract state charaterized by its momentum.
Of course, there is no overlap between $\ket{\Pi(t_{\mathrm{c}})}$ and $\hat{\U}^{\mathrm{ODE}}_0(t,t_0)\ket{\Psi_0(t_0)}$ nor with $\hat{\U}^{\mathrm{tRecX}}_0(t,t_0)\ket{\Psi_0(t_0)}$ since the electron did not get ionisaed yet and we assume no initial population in the continuum \cite{Ivanov20012005}. 
Furthermore, if we expand $\hat{\Hs}^{\mathrm{ODE}}_{\mathrm{I}}(t')$ and $\hat{\Hs}^{\mathrm{tRecX}}_{\mathrm{I}}(t')$ and remind ourself about the orthogonality of the bound states and the continuum states, we see that most of the terms of $\hat{\Hs}_{\mathrm{I}}(t')$ vanish.
We are being left with:
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}^{\mathrm{ODE}}_0(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} \bra{\Pi(t_{\mathrm{c}})} \hat{\U}(t,t')\hat{Y}\hat{\Hs}(t')\hat{X} \hat{\U}^{\mathrm{ODE}}_0(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike1}
\end{equation}
and
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}^{\mathrm{tRecX}}_0(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} \bra{\Pi(t_{\mathrm{c}})} \hat{\U}^{\mathrm{tRecX}}_0(t,t')\hat{Y}\hat{\Hs}(t')\hat{X} \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike2}
\end{equation}
Note: No approximations have been made, \eqref{eq:smatrixlike1} and \eqref{eq:smatrixlike2} are exact.






%%%%%%%%%%%%%%%%%%
\subsection{Strong Field Approximation}
Before making the strong field approximation, lets think about \eqref{eq:smatrixlike1} and \eqref{eq:smatrixlike2} again.
It is best to read this equation from right to left, starting with the initial state of our system and the propagation of the system in presence of a weak electric field before ionisation. 
At moment $t'$ the Laser starts to interact with the system and it transisions into a virtual state \cite{Ivanov20012005}. 
From time $t'$ to the observed time $t$ the system is described by both the physical consequences of laser field and the binding potential.

In principle, SFA is the neglecting of the binding potential once the electron after the ionization. 
Intuition wise this makes sense because the Laser Field is now the dominant force acting on the electron and likely have much mor influence on the electrons ionization dynamics than the coulomb potential.
Also note that SFA is not about high intensity laser pulses since even if we were dealing with for instance small ionisation proabilities (<0.01), SFA states that when ionisation does happen (regardless if its unlikely) the laser pulse will then be the dominant force.

First lets deal with the ODE partitioning. 
We can write time evolution operator after ionisation as:
\begin{equation*}
    %\hat{\Hs}(t) &= \hat{\Hs}_0 + \hat{V}_I(t) = \hat{\Hs}_p + \hat{V}_C + \hat{V}_I(t) 
    %e^{-i \int_{t'}^{t} \hat{\Hs}(t'') \dd t''} &\approx e^{-i \int_{t'}^{t} \hat{\Hs}_{SFA}(t'') \dd t''} \quad \text{with} \quad \hat{\Hs}_{SFA}(t) &= \hat{\Hs}(t) - \hat{V}_C
    \hat{\U}(t,t') \approx \hat{\U}_{\mathrm{SFA}}(t,t')=e^{-i \int_{t'}^{t} \hat{\Hs}_{SFA}(t'') \dd t''} \quad \text{and} \quad \Hs_{\mathrm{SFA}}(t') = \hat{\Hs}(t) - \hat{V}_{\mathrm{C}}      \label{eq:sfa_formula}
\end{equation*}
Similar with the tRecX partitioning:
\begin{equation*}
    \hat{\U}^{\mathrm{tRecX}}_0(t,t') \approx \hat{\U}_{\mathrm{SFA}}(t,t')=e^{-i \int_{t'}^{t} \hat{\Hs}_{SFA}(t'') \dd t''} \quad \text{and} \quad \Hs_{\mathrm{SFA}}(t') = \hat{\Hs}(t) - \hat{V}_{\mathrm{C}}      \label{eq:sfa_formula}
\end{equation*}
It is even possible to write an exact expression for the SFA time evolution operater because now it does indeed commutate with itself at different times.

Further SFA is very usefull because for the eigenstates of $\hat{\Hs}_{\mathrm{SFA}}$ we know an exact analytical solution; the Volkov states.
For that lets take another look at the semi classical Hamilton \eqref{eq:semiClassicalHamilton}. 
Classically, the physics driven by the momentum operator $\hat{\vec{P}}$ is known as the canonical momentum and given by:
\begin{equation}
    \frac{\partial \Ls}{\partial \dot{\uvec{x}}} = \uvec{P} = m\uvec{\dot{x}} + \frac{e}{c}\vec{A} \stackrel{\mathrm{a.u.}}{=} \vec{p} + \vec{A}    \label{eq:canonicalMomentum}
\end{equation}
With $\Ls$ being the Lagrangian of the system.
In our case the canonical momentum is conserved. 
To see this, lets finally set $\varphi=0$ so we have $\vec{E} = -\frac{\partial \vec{A}}{\partial t}$ as justified above and recall the equation of motion for a charged particle in an electromagnetic field \cite{LandauLifschitzBand2}:
\begin{equation*}
    \frac{\dd\vec{p}}{\dd t} = \vec{E} + \left(\uvec{\dot{x}}\times\vec{B}\right) \approx -\frac{\partial \vec{A}}{\partial t} = -\frac{\dd \vec{A}}{\dd t}   %why would i use uvec isntead of vec? doesnt make sense => with x its necessary because its natural variable of lagrandian
\end{equation*}
so $\frac{\dd}{\dd t}\uvec{P}=0$.
And also the energy of the system is clear:
\begin{equation}
    E(t) = \dot{\uvec{x}}\frac{\partial \Ls}{\partial \dot{\uvec{x}}}-\Ls = \frac{\vec{p}^2}{2}     \label{eq:energy}
\end{equation}
Note that the energy is not conserved because the argument we made bevor does not hold for the kinetic momentum only for the canonical momentum.
Now comes the interesting part. 
Clearly $\bra{\Pi(t_{\mathrm{c}})}$ (not $\bra{\vec{p}(t_{\mathrm{c}})}$!) is an eigenstate of $e^{-i \int_{t'}^{t} \hat{\Hs}_{SFA}(t'') \dd t''}$ so combining \eqref{eq:canonicalMomentum} and \eqref{eq:energy} gives us:
\begin{equation*}
    \bra{\Pi(t_c)}e^{-i \int_{t'}^{t} \hat{\Hs}_{SFA}(t'') \dd t''} = \bra{\Pi(t_c)}e^{-i \int_{t'}^{t} (\uvec{P} - \vec{A}(t''))^2 \dd t''}
\end{equation*}
$\uvec{P}$ is of course independent of time, but $\vec{A}$ is not. 
Now we use the fact that the canonical momentum is conserved and calculate the momentum at other times.
In particular we are interested in times where the laser field is long gone:
\begin{equation*}
    \uvec{P} = \vec{p}(t'') + \vec{A}(t'') = \vec{p}(t\rightarrow \infty) + \vec{A}(t\rightarrow \infty) = \vec{p}
\end{equation*}
Furthermore (how??)
\begin{equation*}
    \ket{\Pi} = \ket{\uvec{P}} = \ket{\vec{p}+\vec{A}}
\end{equation*}
Combining all these equations give us the following exprression for both tRecX and ODE:
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}^{\mathrm{ODE}}_0(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} e^{-i \int_{t'}^{t} (\uvec{P} - \vec{A}(t''))^2 \dd t''}\bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\hat{X} \hat{\U}^{\mathrm{ODE}}_0(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike1}
\end{equation}
and
\begin{equation}
    \braket{\Pi(t_{\mathrm{c}})|\,\hat{\U}^{\mathrm{tRecX}}_0(t,t_0)\ket{\Psi_0(t_0)}} = -i \int_{t_0}^{t} e^{-i \int_{t'}^{t} (\uvec{P} - \vec{A}(t''))^2 \dd t''}\bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\hat{X} \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} \dd t' \label{eq:smatrixlike2}
\end{equation}
Note that SFA wiped out the difference in the left part of the integrand between ODE and tRecX so now both equation are indeed different from each other.
Now comes the part thats actually new, an approximation about $\hat{\U}^{\mathrm{ODE}}_0(t',t_0)\ket{\Psi_0(t_0)}$ and $\hat{\U}(t',t_0)\ket{\Psi_0(t_0)}$.

\paragraph{ODE}
Whatever the final form may look like, it can certainly be expanded in the bound states $\ket{\Psi_n}$. 
This can be seen by writing the defining equation of the time evolution operator and noting that if the $\hat{\U}^{\mathrm{ODE}}_0(t',t_0)\ket{\Psi_0(t_0)}$ would have any overlap with a state not representable by the bound state, it would cancel out due to $\hat{X}$.
With this in mind we can make an ansatz using the interaction picture as:
\begin{equation*}
    \hat{\U}^{\mathrm{ODE}}_0(t',t_0)\ket{\Psi_0(t_0)} = \sum_{n}c_n(t')e^{-iE_nt'}\ket{\Psi_n}
\end{equation*}
The factors $e^{-iE_nt'}$ were factored out because they might cause some numerical problems later on because they oscillate very fast.

In theory this ansatz is exact but with the implicit assumption that the hilbertspaces can be seperated that easily. 
Also I assumed that the bound states are not affected by the laser field, which is not true in reality.
However, this can be justified later by the fact that the laser intensity is low enough and the ionization propability does not exceed 0.01.

\paragraph{tRecX}
This time its a much harder approximation.
The only thing that benefits here is that we only want the time evolution until moment of ionization $t'$.
We also make the same assumptions about the laser intensity and the ionization proability as before.
That justifies that this time evolution can also be approximated by a superposition of the bound states:
\begin{equation*}
    \hat{\U}(t',t_0)\ket{\Psi_0(t_0)} = \sum_{n}c_n(t')e^{-iE_nt'}\ket{\Psi_n}
\end{equation*}

\bigskip

The only thing that differs from both ansatzes are the coefficients $c_n(t')$.
In the ODE case they are retrieved by solving the TDSE in the subspace spanned by the boundstates.
In other words, we cut off ionization and force the electron to stay inside the subspace (even if we would increase the laser intensity arbitrarily high).
If one tries to do this this will lead you to an system of ordinary differential equations that solve for the coefficients, there the name.
However, the tRecX approach is fundamentally different.
In this case one has to solve the TDSE in the whole hilbertspace and then extract the coefficients at the times $t'$.
In the atto/femtosecond regime this requires a lot of computational power and efficiency since the electron leaves the subhilbertspace within this process.
For these numerical simulations I used a nmuerical solver (chapter 3) called tRecX.
That motivates the name.

In contrast to other literature (\cite{Theory_NPS}, \cite{Ivanov20012005}) tis ansatz does not not neglect transitions between different bound states before the ionisation. 
For instance it can happen that the laserpulse excites the electron but doesnt ionise it quite yet. 
The coefficients should contain all the relevant information that happen inside a hydrogen atom before ionization (effects like DC/AC stark shift, distortion of ground state etc.).

Lets first write the final expression. 
With some simplification of the dipole matrix element $\vec{d}_n(\vec{p}+\vec{A}) = \bra{\vec{p}+\vec{A}}\hat{\Hs}(t')\ket{\Psi_n}$ between the bound state and the continuum state one can apply the dipole approximation \eqref{eq:dipoleApprox} and lets us write:
\begin{equation*}
    \braket{\Pi(t_{\mathrm{c}})|\Psi_n(t)} = -\frac{i}{2}\int_{t_0}^{t} e^{-i \int_{t'}^{t} (\uvec{P} - A_z(t''))^2 \dd t''}E_z(t')\sum_{n}c_n(t)e^{-iE_nt'}\bra{\vec{p}+A_z}\hat{d}_z\ket{\Psi_n} \dd t'       \label{eq:smatrix}
\end{equation*}
Where we used the fact that the electric field is polarized along the z axis.
This is the equation where most papers start with \cite{Theory_NPS} known as Strong field s matrix in length gauge but with the key difference that this equation does not neglect excited states.




%%%%%%%%%%%%%%%%%%%%
\section{Ionization rates}
What is a ionization rate and why do we want to have it?\\
Dilemma: numerical simulations yield good ion propabilitiees but no ionization rate, analytical calculations yield good ionization rates but incorrect propabilities (see GASFIR paper).
Furthermore, no experimental method has been developed yet to measure ionization rates, only ionization propabilities - a quantum mechanical observable.\\
As long as the electromagnetic
field is present, projecting onto bound/unbound states
yields non-physical gauge-dependent predictions [14].\\       % M. Yuan, P. Xin, T. Chu, H. Liu, Optics Express 2017,25, 19 23493
Tunneling time is imaginary, source???\\











%%%%%%%%%%%%%%%%%%%%%
\subsection{Derivation of SFA Rate}
This mainly follows \cite{Theory_NPS} with some modification.\\
First we write the ionization propability as the amplitude of projection of the wavefunction onto the continuum supspace.
The ionization rate integrated over the time domain should yield the total ionization propability.
Therefore we can write the SFA rate \eqref{eq:smatrix} as:
\begin{align*}
    \lim_{t\to\infty}\braket{\Psi(t)|\int \dd^3 p \ket{p}\bra{p}\Psi(t)} = &\int_{-\infty}^{\infty} \Gamma_{\mathrm{SFA}}(t) \dd t \\ %= \int_{\R^3}\dd^3p \braket{\Psi_n(t)|\Pi(t_{\mathrm{c}})}\braket{\Pi(t_{\mathrm{c}})|\Psi_n(t)}\\ 
    = &\int \dd^3 p \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \dd t_1  \dd t_2 \, e^{\frac{i}{2}\int_{t_1}^{t_2}(\uvec{p}+A_z(t''))^2\dd t''} E_z(t_1)E_z(t_2)\\
    &\times\left(\sum_{n}e^{iE_nt_1}c_n^*(t_1)d_{z,n}^*(\uvec{p}+A_z(t_1))\right)\left(\sum_{n}e^{-iE_nt_2}c_n(t_2)d_{z,n}(\uvec{p}+A_z(t_2))\right)
\end{align*}
Changing variables to $t=\frac{t_2+t_1}{2}$ and $T=\frac{t_2-t_1}{2}$ and using the fact that our Laser pulse is polarized along the z Axis gives us:
\begin{align*}
    \Gamma_{\mathrm{SFA}}(t) &= \int \dd^3 p \int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{t-T}^{t+T}(\uvec{p}+A_z(t''))^2\dd t''} E_z(t-T) E_z(t+T)\\
    &\times\left(\sum_{n}e^{i(t-T)E_n}c_n^*(t-T)d_{z,n}^*(\uvec{p}+A_z(t-T))\right)\left(\sum_{n}e^{-i(t+T)E_n}c_n(t+T)d_{z,n}(\uvec{p}+A_z(t+T))\right)\\
    &= \sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta\,\sin\theta \int_0^{2\pi}\dd \phi\int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{t-T}^{t+T}(\uvec{p}+A_z(t''))^2\dd t''} e^{i(t-T)E_{n_1}-i(t+T)E_{n_2}}\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\uvec{p}+A_z(t-T))d_{z,n_2}(\uvec{p}+A_z(t+T))
\end{align*}
Now we change the integration from $\vec{p}$ to $\vec{p}+\vec{A}$ and defining $\vec{\Delta}(t') = \vec{A}(t+t') - \vec{A}(t)$ gives us:
\begin{align*}
    &\sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta\,\sin\theta \int_0^{2\pi}\dd \phi\int_{-\infty}^{\infty} \dd T \, e^{\frac{i}{2}\int_{-T}^{T}(\uvec{p}+\Delta_z(t''))^2\dd t''} e^{i(t-T)E_{n_1}-i(t+T)E_{n_2}}\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\uvec{p}+\Delta_z(-T))d_{z,n_2}(\uvec{p}+\Delta_z(T))
\end{align*}
Also the integrand in the exponential function can be further simplifyed:
\begin{align*}
    \frac{i}{2}\int_{-T}^{T}(\vec{p}+\Delta_z(t''))^2\dd t'' &= i\vec{p}^2T + \frac{i}{2}\int_{-T}^{T}\Delta_z(t'')^2+2\vec{p}\cdot\Delta_z(t'')\dd t'' \\
    &= i\vec{p}^2T + ip\cos\theta\int_{-T}^{T}\Delta_z(t'')\dd t'' +  \frac{i}{2}\int_{-T}^{T}\Delta_z(t'')^2\dd t''
\end{align*}
Because in the code as well as in \cite{Theory_NPS} the notation
\begin{equation*}
    \vec{\bar{\Delta}}^k = \int_{-T}^{T}\vec{\Delta}^k(t')\dd t' = \int_{-T}^{T}\left(\vec{A}(t+t') - \vec{A}(t)\right)^k\dd t'
\end{equation*}
was used, we can write the final SFA rate thats later being implemented as
\begin{align*}
    \Gamma_{\mathrm{SFA}}(t) &= \sum_{n_1}\sum_{n_2} \int_0^{\infty} \dd p\,p^2\int_0^{\pi} \dd\theta\,\sin\theta \int_0^{2\pi}\dd \phi\int_{-\infty}^{\infty} \dd T\\
    &\times \exp\left(i\vec{p}^2T + ip\cos\theta\bar{\Delta}_z^k +  \frac{i}{2}\bar{\Delta}_z^2  + i(t-T)E_{n_1}-i(t+T)E_{n_2}\right)\\
    &\times E_z(t-T) E_z(t+T)c_{n_1}^*(t-T)c_{n_2}(t+T) d_{z,n_1}^*(\uvec{p}+\Delta_z(-T))d_{z,n_2}(\uvec{p}+\Delta_z(T))
\end{align*}
For numerical calculations it can be convenient to split a complex integrand into its phase and absolute value. 
Mostly this is beong done with this formula, but the coefficients remain complex and may have a very fast oscillating phase.









%%%%%%%%%%%%%%%%%%%%%
\newpage
\section{Strong Field Ionization}
This mostly follows [master manoram thesis].
This section is not directly needed for this thesis but in most literature theese terms are often used so I quickly mention them.
Ionization can occur in different ways, depending on the laser parameters and the atom or material used. 
To distinguish these two processes, we need to define some parameters. 
According to \cite{Keldysh:1965ojf} the strong field ionization depends mostly on three parameters: the photon energy, the binding potential and the ponderomotive energy.


\paragraph{Ponderomotive Energy}
The ponderomotive energy is the cycle-averaged quiver energy of a free electron in an electromagnetic field. [cite wikipedia]
Since the particle experiences harmonic motion, the time-averaged kinetic energy is given by 
\begin{equation*}
    \frac{1}{2}m\omega^2 \braket{x^2}=\frac{e^2E^2}{4m_e\omega^2} = \frac{E^2}{4\omega^2}
\end{equation*}

\paragraph{Keldysh Parameter}
The Keldysh parameter $\gamma$ compares the ponderomotive energy with the ionization potential. 
It is defined as
\begin{equation*}
    \gamma = \sqrt{\frac{I_p}{2U_p}}
\end{equation*}
The ionization potential in the hydrogen atom is $I_p = 13.6\mathrm{eV} = 0.5 \mathrm{au.}$
Depending on what the keldysh parameter is, one can define different regimes of ionization with different physical interpretations.



%how much should i write about these kind of things???
\subsection{Tunneling ionization}
Usually one can define this regime with $\gamma \ll 1$.
The laser pulse is so strong that it distorts the potential barrier.
However one can also define it with saying the tunneling regime is where the quasi static approximation holds, i.e the instantanious ionization rate is entirely defined by the absolute value of the electric field at that time \cite{manorammasterthesis}. 
That makes it possible to calculate the ionization rate for DC and AC fields in this regime analytically \cite{tunnel_ion_complexatoms}. 
\begin{equation*}
    \Gamma_{\mathrm{SFA}}(t) \propto \exp\left(-\frac{2}{3}\frac{(2I_p)^{3/2}}{F}\right)
\end{equation*}
With $F$ being the peak of the electric field for an AC field. 




\subsection{Multiphoton ionization}
The regime where $\gamma \gg 1$ is mostly called multiphoton ionization. 
This is espeically when the field strength is far weaker than in the tunneling regime
In other words, multiphotonregime can be defined as the regime where
\begin{equation*}
    \Gamma_{\mathrm{SFA}}(t) \propto \vec{E}^{2N} \quad \text{with} \quad N = \frac{I_p}{E_e}
\end{equation*}
is valid \cite{Ivanov20012005}. 
You can imagine it as the electron is being heated up, gaining energy while still under the barrier.
That makes it the complete opposite of the tunneling regime, being non adiabatic.
For deeper insight, refer to \cite{Ivanov20012005} and \cite{Keldysh:1965ojf}.



\subsection{Intermediate regime}
This is the most important regime for this thesis. 
Previous regimes just define limits, when the complementary process is neglible.
But in reality its more an coexistence of both processes.
In this intermediate regime, the tunneling process is no longer adiabatic. 
This means the potential barrier oscillates significantly during the time it takes for the electron to tunnel through it. 
As a result, the electron can absorb energy from the laser field while it is tunneling. 