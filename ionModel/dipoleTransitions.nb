(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61232,       1610]
NotebookOptionsPosition[     58909,       1564]
NotebookOutlinePosition[     59304,       1580]
CellTagsIndexPosition[     59261,       1577]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Analytical calculation of dipole transition matrix elements\n", 
  "Title"],
 StyleBox["Gegenbauer Polynomials\n", "Section"],
 "Implementation of formula in Bransen and Joachim"
}], "Text",
 CellChangeTimes->{{3.955128049035934*^9, 3.955128087723094*^9}, 
   3.955128293218657*^9, {3.955518893763425*^9, 
   3.955518893938731*^9}},ExpressionUUID->"5b62773b-5fb4-4107-9dc0-\
ec3b8108cdfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phipGegen", "[", 
    RowBox[{
    "n_", ",", "l_", ",", "m_", ",", "p_", ",", "\[Theta]p_", ",", 
     "\[Phi]p_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"2", "/", "\[Pi]"}], "*", 
      RowBox[{
       RowBox[{"Factorial", "[", 
        RowBox[{"n", "-", "l", "-", "1"}], "]"}], "/", 
       RowBox[{"Factorial", "[", 
        RowBox[{"n", "+", "l"}], "]"}]}]}], "]"}], "*", 
    RowBox[{"n", "^", "2"}], "*", 
    RowBox[{"2", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "l"}], "+", "2"}], ")"}]}], "*", 
    RowBox[{"Factorial", "[", "l", "]"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "^", "l"}], "*", 
       RowBox[{"p", "^", "l"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "^", "2"}], " ", 
          RowBox[{"p", "^", "2"}]}], "+", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"l", "+", "2"}], ")"}]}], ")"}]}], "*", 
    RowBox[{"GegenbauerC", "[", 
     RowBox[{
      RowBox[{"n", "-", "l", "-", "1"}], ",", 
      RowBox[{"l", "+", "1"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "^", "2"}], "*", 
          RowBox[{"p", "^", "2"}]}], "-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "^", "2"}], "*", 
          RowBox[{"p", "^", "2"}]}], "+", "1"}], ")"}]}]}], "]"}], "*", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"phipGegen", "[", 
   RowBox[{
   "1", ",", "0", ",", "0", ",", " ", "p", ",", " ", "\[Theta]p", ",", " ", 
    "\[Phi]p"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"phipGegen", "[", 
   RowBox[{
   "2", ",", "1", ",", "0", ",", " ", "p", ",", " ", "\[Theta]p", ",", " ", 
    "\[Phi]p"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"phipGegen", "[", 
         RowBox[{
         "n", ",", "l", ",", "m", ",", " ", "p", ",", " ", "\[Theta]p", ",", 
          " ", "\[Phi]p"}], "]"}], ",", " ", "p"}], "]"}], "*", 
      RowBox[{"Cos", "[", "\[Theta]p", "]"}]}], "-", 
     RowBox[{GridBox[{
        {"1"},
        {"p"}
       }], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"phipGegen", "[", 
         RowBox[{
         "n", ",", "l", ",", "m", ",", " ", "p", ",", " ", "\[Theta]p", ",", 
          " ", "\[Phi]p"}], "]"}], ",", " ", "\[Theta]p"}], "]"}], "*", 
      RowBox[{"Sin", "[", "\[Theta]p", "]"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"m", ",", 
      RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.95474981154941*^9, 3.954749914545717*^9}, {
   3.9547499485127945`*^9, 3.95474994932226*^9}, {3.954750098090948*^9, 
   3.954750104338083*^9}, {3.954750141763609*^9, 3.9547501451839027`*^9}, {
   3.9547501793865643`*^9, 3.954750201022709*^9}, 3.954750249791617*^9, {
   3.954750383792425*^9, 3.954750385755802*^9}, {3.95475048076915*^9, 
   3.954750524846607*^9}, {3.9547505933877964`*^9, 3.954750593774564*^9}, {
   3.954842833546138*^9, 3.954842836890195*^9}, {3.957180061144198*^9, 
   3.957180092669213*^9}, {3.957240190634545*^9, 3.957240207580241*^9}, {
   3.9572406198694267`*^9, 3.957240628870557*^9}, {3.957240669670974*^9, 
   3.957240743362627*^9}, {3.957241222375992*^9, 3.95724132965076*^9}, {
   3.9572457520520782`*^9, 3.957245787421514*^9}, {3.957335981289588*^9, 
   3.957335989940536*^9}, {3.9573400541080503`*^9, 3.9573400744127617`*^9}, {
   3.957340457234314*^9, 3.957340458042111*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"b465ff2b-6010-2a49-a903-d73b3d86ad12"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SqrtBox["2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["p", "2"]}], ")"}], "2"], " ", "\[Pi]"}]]], "Output",
 CellChangeTimes->{{3.954749859755087*^9, 3.954749954426241*^9}, 
   3.954750104894293*^9, {3.954750142553868*^9, 3.954750145659231*^9}, 
   3.9547502053364887`*^9, 3.9547502501420555`*^9, 3.954750388111149*^9, {
   3.954750470142533*^9, 3.954750532416336*^9}, {3.9547505780190086`*^9, 
   3.954750596004244*^9}, 3.95484283796024*^9, {3.95718006779217*^9, 
   3.957180093497682*^9}, {3.957240201512524*^9, 3.95724020793151*^9}, 
   3.9572407450657253`*^9, {3.957241241763748*^9, 3.957241255701789*^9}, {
   3.957241289484917*^9, 3.9572412970078917`*^9}, 3.957241330755763*^9, {
   3.957245767383127*^9, 3.957245788027539*^9}, {3.957335982776941*^9, 
   3.957335990355055*^9}, {3.957340063391583*^9, 3.95734007629173*^9}},
 CellLabel->"Out[6]=",ExpressionUUID->"32bd984e-2717-4e08-ac24-afd384eb482f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"64", " ", "p", " ", 
   RowBox[{"Cos", "[", "\[Theta]p", "]"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["p", "2"]}]}], ")"}], "3"], " ", "\[Pi]"}]]], "Output",
 CellChangeTimes->{{3.954749859755087*^9, 3.954749954426241*^9}, 
   3.954750104894293*^9, {3.954750142553868*^9, 3.954750145659231*^9}, 
   3.9547502053364887`*^9, 3.9547502501420555`*^9, 3.954750388111149*^9, {
   3.954750470142533*^9, 3.954750532416336*^9}, {3.9547505780190086`*^9, 
   3.954750596004244*^9}, 3.95484283796024*^9, {3.95718006779217*^9, 
   3.957180093497682*^9}, {3.957240201512524*^9, 3.95724020793151*^9}, 
   3.9572407450657253`*^9, {3.957241241763748*^9, 3.957241255701789*^9}, {
   3.957241289484917*^9, 3.9572412970078917`*^9}, 3.957241330755763*^9, {
   3.957245767383127*^9, 3.957245788027539*^9}, {3.957335982776941*^9, 
   3.957335990355055*^9}, {3.957340063391583*^9, 3.957340076292848*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"a7708a11-5b81-43fe-ab5a-2e19d4c48633"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"m", "=", 
       RowBox[{"-", "l"}]}], "l"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["7", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "l"}], ")"}], " ", 
            SuperscriptBox["n", 
             RowBox[{"2", "+", "l"}]], " ", 
            SuperscriptBox["p", "l"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["n", "2"], " ", "p", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{
                    SuperscriptBox["n", "2"], " ", 
                    SuperscriptBox["p", "2"]}]}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["n", "2"], " ", 
                    SuperscriptBox["p", "2"]}]}], ")"}], "2"]]}], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox["n", "2"], " ", "p"}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], ")"}], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"2", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["7", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}], ")"}], " ", 
            SuperscriptBox["n", 
             RowBox[{"4", "+", "l"}]], " ", 
            SuperscriptBox["p", 
             RowBox[{"1", "+", "l"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "3"}], "-", "l"}]], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"1", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["5", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", "l", " ", 
            SuperscriptBox["n", 
             RowBox[{"2", "+", "l"}]], " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "l"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}]], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"1", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["\[Pi]"]], 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{
           FractionBox["5", "2"], "+", 
           RowBox[{"2", " ", "l"}]}]], " ", 
         SuperscriptBox["n", 
          RowBox[{"2", "+", "l"}]], " ", 
         SuperscriptBox["p", "l"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             SuperscriptBox["p", "2"]}]}], ")"}], 
          RowBox[{
           RowBox[{"-", "2"}], "-", "l"}]], " ", 
         RowBox[{"l", "!"}], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
         RowBox[{"GegenbauerC", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
           RowBox[{"1", "+", "l"}], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              SuperscriptBox["p", "2"]}]}], 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"Cot", "[", "\[Theta]p", "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]p"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", "l", "-", "m"}], "]"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"2", "+", "l", "+", "m"}], "]"}]], " ", 
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", 
               RowBox[{"1", "+", "m"}], ",", "\[Theta]p", ",", "\[Phi]p"}], 
              "]"}]}], 
            RowBox[{
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"l", "-", "m"}], "]"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", "l", "+", "m"}], "]"}]]}]]}], ")"}]}]}]}], 
      ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"m", "=", 
       RowBox[{"-", "l"}]}], "l"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["7", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "l"}], ")"}], " ", 
            SuperscriptBox["n", 
             RowBox[{"2", "+", "l"}]], " ", 
            SuperscriptBox["p", "l"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"2", " ", 
                 SuperscriptBox["n", "2"], " ", "p", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{
                    SuperscriptBox["n", "2"], " ", 
                    SuperscriptBox["p", "2"]}]}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{
                    SuperscriptBox["n", "2"], " ", 
                    SuperscriptBox["p", "2"]}]}], ")"}], "2"]]}], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                SuperscriptBox["n", "2"], " ", "p"}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], ")"}], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"2", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["7", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}], ")"}], " ", 
            SuperscriptBox["n", 
             RowBox[{"4", "+", "l"}]], " ", 
            SuperscriptBox["p", 
             RowBox[{"1", "+", "l"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "3"}], "-", "l"}]], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"1", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{
              FractionBox["5", "2"], "+", 
              RowBox[{"2", " ", "l"}]}]], " ", "l", " ", 
            SuperscriptBox["n", 
             RowBox[{"2", "+", "l"}]], " ", 
            SuperscriptBox["p", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "l"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}]}], ")"}], 
             RowBox[{
              RowBox[{"-", "2"}], "-", "l"}]], " ", 
            RowBox[{"l", "!"}], " ", 
            SqrtBox[
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
            RowBox[{"GegenbauerC", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
              RowBox[{"1", "+", "l"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}], 
               RowBox[{"1", "+", 
                RowBox[{
                 SuperscriptBox["n", "2"], " ", 
                 SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], 
           SqrtBox["\[Pi]"]]}], ")"}]}], "-", 
       RowBox[{
        FractionBox["1", 
         SqrtBox["\[Pi]"]], 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{
           FractionBox["5", "2"], "+", 
           RowBox[{"2", " ", "l"}]}]], " ", 
         SuperscriptBox["n", 
          RowBox[{"2", "+", "l"}]], " ", 
         SuperscriptBox["p", 
          RowBox[{"1", "+", "l"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             SuperscriptBox["p", "2"]}]}], ")"}], 
          RowBox[{
           RowBox[{"-", "2"}], "-", "l"}]], " ", 
         RowBox[{"l", "!"}], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", "l", "+", "n"}], ")"}], "!"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "n"}], ")"}], "!"}]]], " ", 
         RowBox[{"GegenbauerC", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "-", "l", "+", "n"}], ",", 
           RowBox[{"1", "+", "l"}], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              SuperscriptBox["p", "2"]}]}], 
            RowBox[{"1", "+", 
             RowBox[{
              SuperscriptBox["n", "2"], " ", 
              SuperscriptBox["p", "2"]}]}]]}], "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]p", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"Cot", "[", "\[Theta]p", "]"}], " ", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], 
             "]"}]}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]p"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", "l", "-", "m"}], "]"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"2", "+", "l", "+", "m"}], "]"}]], " ", 
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", 
               RowBox[{"1", "+", "m"}], ",", "\[Theta]p", ",", "\[Phi]p"}], 
              "]"}]}], 
            RowBox[{
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"l", "-", "m"}], "]"}]], " ", 
             SqrtBox[
              RowBox[{"Gamma", "[", 
               RowBox[{"1", "+", "l", "+", "m"}], "]"}]]}]]}], ")"}]}]}]}], 
      ")"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.954749859755087*^9, 3.954749954426241*^9}, 
   3.954750104894293*^9, {3.954750142553868*^9, 3.954750145659231*^9}, 
   3.9547502053364887`*^9, 3.9547502501420555`*^9, 3.954750388111149*^9, {
   3.954750470142533*^9, 3.954750532416336*^9}, {3.9547505780190086`*^9, 
   3.954750596004244*^9}, 3.95484283796024*^9, {3.95718006779217*^9, 
   3.957180093497682*^9}, {3.957240201512524*^9, 3.95724020793151*^9}, 
   3.9572407450657253`*^9, {3.957241241763748*^9, 3.957241255701789*^9}, {
   3.957241289484917*^9, 3.9572412970078917`*^9}, 3.957241330755763*^9, {
   3.957245767383127*^9, 3.957245788027539*^9}, {3.957335982776941*^9, 
   3.957335990355055*^9}, 3.957340063391583*^9, 3.957340225799556*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"36d6db6b-9db3-44c9-8c9f-f14f169112f4"]
}, Open  ]],

Cell[TextData[{
 StyleBox["Analytical Formula\n", "Section"],
 "Using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "\[Pi]"}], ")"}], 
    RowBox[{"3", "/", "2"}]], TraditionalForm]],ExpressionUUID->
  "1bf6285d-d3a2-490b-9fc8-93fa22f7c14c"],
 "for fourier transform"
}], "Text",
 CellChangeTimes->{{3.955127992659801*^9, 3.955127996085127*^9}, {
  3.955518883902155*^9, 
  3.9555188847612743`*^9}},ExpressionUUID->"8cbcfe88-1969-4492-936a-\
fd3e791ecb3b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"4", "\[Pi]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], 
      FractionBox["3", "2"]]], "*", 
    SuperscriptBox["I", "l"], "*", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"2", "Z"}], 
         RowBox[{"n", " "}]], ")"}], "3"], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "l", "-", "1"}], ")"}], "!"}], 
       RowBox[{"2", "n", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "l"}], ")"}], "!"}]}]]}]], "*", 
    RowBox[{"Binomial", "[", 
     RowBox[{
      RowBox[{"n", "+", "l"}], ",", 
      RowBox[{"n", "-", "l", "-", "1", "-", "\[Iota]"}]}], "]"}], "*", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "\[Iota]"], 
     RowBox[{"\[Iota]", "!"}]], "*", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["r", "2"], "*", 
       RowBox[{"SphericalBesselJ", "[", 
        RowBox[{"l", ",", " ", 
         RowBox[{"p", "*", "r"}]}], "]"}], "*", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"Z", "*", "r"}], "n"]}], "]"}], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"2", "Z", "*", " ", "r"}], 
          RowBox[{"n", " "}]], ")"}], "l"], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"2", "Z", " ", "*", "r"}], 
          RowBox[{"n", " "}]], ")"}], "\[Iota]"]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"r", ",", "0", ",", "Infinity"}], "}"}]}], "]"}], "*", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], "]"}]}], ",", 
   " ", 
   RowBox[{"Assumptions", "->", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "\[Element]", "Integers"}], "&&", 
        RowBox[{"n", ">", "0"}]}], ",", 
       RowBox[{
        RowBox[{"l", "\[Element]", "Integers"}], "&&", 
        RowBox[{"l", "<", "n"}]}], ",", 
       RowBox[{
        RowBox[{"m", "\[Element]", "Integers"}], "&&", 
        RowBox[{
         RowBox[{"-", "l"}], "<=", "m", "<=", "l"}]}]}], "}"}]}]}]}], 
  "]"}]], "Input",
 TaggingRules->{},
 CellChangeTimes->{
  3.832089371424816*^9, {3.955011715415311*^9, 3.95501174019026*^9}, {
   3.955011773897718*^9, 3.955011783345542*^9}, {3.955011818347835*^9, 
   3.955011942555519*^9}, {3.955011987296342*^9, 3.9550119927704687`*^9}, {
   3.955012064256415*^9, 3.955012193156863*^9}, {3.955012323012523*^9, 
   3.955012323865912*^9}, {3.955012376320093*^9, 3.955012376406362*^9}, {
   3.9550124614760027`*^9, 3.955012486601265*^9}, {3.955012624976046*^9, 
   3.955012630916092*^9}, {3.95501273198827*^9, 3.9550127362913218`*^9}, {
   3.9550130003918*^9, 3.955013136843438*^9}, {3.9550140980647783`*^9, 
   3.955014168337989*^9}, {3.955014223903651*^9, 3.9550142561573787`*^9}, {
   3.955014895771843*^9, 3.955014899550968*^9}, {3.955015395155783*^9, 
   3.955015434195112*^9}, {3.955015771936367*^9, 3.955015884751246*^9}, {
   3.955016024011404*^9, 3.95501605735884*^9}, {3.955016151470406*^9, 
   3.955016210669044*^9}, {3.955016242973121*^9, 3.955016246499679*^9}, {
   3.955016312934199*^9, 3.955016369099533*^9}, {3.955020065988431*^9, 
   3.955020074774778*^9}, {3.955020109237355*^9, 3.955020119335702*^9}, {
   3.955020423560141*^9, 3.955020426002569*^9}, {3.9550205454721746`*^9, 
   3.955020551826934*^9}, {3.955082003248172*^9, 3.955082006943137*^9}, 
   3.9550835263302193`*^9, {3.9550835659443283`*^9, 3.955083589013681*^9}, {
   3.955083903026025*^9, 3.955083991617446*^9}, {3.9550840760895844`*^9, 
   3.955084079532859*^9}, 3.955084152172649*^9, {3.9550842005598*^9, 
   3.9550842297815437`*^9}, 3.95508444803018*^9, {3.955084481500397*^9, 
   3.955084538456023*^9}, {3.955084744452815*^9, 3.9550847652612762`*^9}, {
   3.95508480683321*^9, 3.955084807140385*^9}, {3.9550850991893063`*^9, 
   3.955085174867739*^9}, {3.955085677931308*^9, 3.955085705809206*^9}, {
   3.955085960039755*^9, 3.955085962799937*^9}, 3.955428635131602*^9, {
   3.955428737835429*^9, 3.955428742168614*^9}, {3.955428779202173*^9, 
   3.955428779755364*^9}, {3.9554323083955584`*^9, 3.955432311126726*^9}, {
   3.955432342660954*^9, 3.955432343258733*^9}, {3.955432483329652*^9, 
   3.9554324862313004`*^9}, 3.9555148295641747`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"777a70d3-f19f-4eb2-8ffc-0a2e5f7c48e0"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{
     FractionBox["1", 
      RowBox[{"\[Iota]", "!"}]], 
     RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "\[Iota]"], " ", 
       SuperscriptBox["\[ImaginaryI]", "l"], " ", 
       SuperscriptBox["2", 
        RowBox[{
          FractionBox["1", "2"], "+", "\[Iota]"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
          SuperscriptBox["p", "2"], ")"}], 
        RowBox[{"l", "/", "2"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
          FractionBox["Z", "n"], ")"}], 
        RowBox[{
          RowBox[{"-", "3"}], "-", "l"}]], " ", 
       RowBox[{"Binomial", "[", 
         RowBox[{
           RowBox[{"l", "+", "n"}], ",", 
           RowBox[{
             RowBox[{"-", "1"}], "-", "l", "+", "n", "-", "\[Iota]"}]}], 
         "]"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
           SuperscriptBox["Z", "3"], " ", 
           RowBox[{"Gamma", "[", 
             RowBox[{
               RowBox[{"-", "l"}], "+", "n"}], "]"}]}], 
         RowBox[{
           SuperscriptBox["n", "4"], " ", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{"l", "+", "n"}], ")"}], "!"}]}]]], " ", 
       RowBox[{"Gamma", "[", 
         RowBox[{"3", "+", 
           RowBox[{"2", " ", "l"}], "+", "\[Iota]"}], "]"}], " ", 
       RowBox[{"Hypergeometric2F1Regularized", "[", 
         RowBox[{
           RowBox[{"2", "+", "l", "+", 
             FractionBox["\[Iota]", "2"]}], ",", 
           RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
               RowBox[{"3", "+", 
                 RowBox[{"2", " ", "l"}], "+", "\[Iota]"}], ")"}]}], ",", 
           RowBox[{
             FractionBox["3", "2"], "+", "l"}], ",", 
           RowBox[{"-", 
             FractionBox[
              RowBox[{
                SuperscriptBox["n", "2"], " ", 
                SuperscriptBox["p", "2"]}], 
              SuperscriptBox["Z", "2"]]}]}], "]"}], " ", 
       RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], "]"}]}]}], 
   RowBox[{
     RowBox[{"n", "\[NotEqual]", "0"}], "&&", 
     RowBox[{
       RowBox[{"l", "+", 
         RowBox[{"Conjugate", "[", "l", "]"}], "+", 
         RowBox[{"Re", "[", "\[Iota]", "]"}]}], ">", 
       RowBox[{"-", "3"}]}]}]},
  "ConditionalExpression"]], "Output",
 CellChangeTimes->{{3.955011736305696*^9, 3.955011741712327*^9}, {
   3.9550117796341057`*^9, 3.955011783813706*^9}, {3.955011826377348*^9, 
   3.955011831245051*^9}, {3.955011864378632*^9, 3.955011870714678*^9}, {
   3.955012061233194*^9, 3.955012129383582*^9}, 3.9550121969214*^9, 
   3.955012272227096*^9, 3.9550123257579823`*^9, 3.955012373263852*^9, 
   3.955012433529243*^9, 3.9550126428402233`*^9, 3.955012692638876*^9, 
   3.955012911887859*^9, 3.955013295938285*^9, 3.955014211295456*^9, 
   3.955014243934998*^9, 3.955014436240252*^9, 3.955015070737529*^9, 
   3.955015360537115*^9, 3.955015425059766*^9, 3.955015743959069*^9, {
   3.955015782875698*^9, 3.955015812286978*^9}, 3.955016215735477*^9, 
   3.955016293398944*^9, 3.9550166431349173`*^9, 3.955020167704406*^9, 
   3.955020463830218*^9, 3.955020588483336*^9, 3.955082054970433*^9, 
   3.955083558516457*^9, 3.955083633971344*^9, 3.955083986092511*^9, 
   3.955084032570453*^9, 3.955084114006664*^9, 3.955084194837346*^9, 
   3.955084233794767*^9, 3.955084316295228*^9, 3.955084531914893*^9, 
   3.955084622297404*^9, 3.955084813492165*^9, 3.9550848987905617`*^9, 
   3.955085674173868*^9, 3.9550857084437327`*^9, 3.95508579916225*^9, 
   3.955086000716637*^9, 3.955086283913816*^9, 3.955428875294503*^9, 
   3.955432340508628*^9, 3.955432398119112*^9, 3.955514921309354*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"812755c5-a52c-4df6-b47f-2d8a97a77cb5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phipAnalytical", "[", 
    RowBox[{"n_", ",", "l_", ",", "p_", ",", "\[Theta]p_", ",", "\[Phi]p_"}], 
    "]"}], " ", ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Iota]", "!"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "\[Iota]"], " ", 
        SuperscriptBox["\[ImaginaryI]", "l"], " ", 
        SuperscriptBox["2", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[Iota]"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["p", "2"], ")"}], 
         RowBox[{"l", "/", "2"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["Z", "n"], ")"}], 
         RowBox[{
          RowBox[{"-", "3"}], "-", "l"}]], " ", 
        RowBox[{"Binomial", "[", 
         RowBox[{
          RowBox[{"l", "+", "n"}], ",", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "l", "+", "n", "-", "\[Iota]"}]}], "]"}], 
        " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["Z", "3"], " ", 
           RowBox[{"Gamma", "[", 
            RowBox[{
             RowBox[{"-", "l"}], "+", "n"}], "]"}]}], 
          RowBox[{
           SuperscriptBox["n", "4"], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l", "+", "n"}], ")"}], "!"}]}]]], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", "l"}], "+", "\[Iota]"}], "]"}], " ", 
        RowBox[{"Hypergeometric2F1Regularized", "[", 
         RowBox[{
          RowBox[{"2", "+", "l", "+", 
           FractionBox["\[Iota]", "2"]}], ",", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"2", " ", "l"}], "+", "\[Iota]"}], ")"}]}], ",", 
          RowBox[{
           FractionBox["3", "2"], "+", "l"}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             SuperscriptBox["p", "2"]}], 
            SuperscriptBox["Z", "2"]]}]}], "]"}], " ", 
        RowBox[{"SphericalHarmonicY", "[", 
         RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Iota]", ",", "0", ",", 
         RowBox[{"n", "-", "l", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phipAnalytical", "[", 
         RowBox[{"1", ",", "0", ",", "p", ",", "\[Theta]p", ",", "\[Phi]p"}], 
         "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["px", "2"], " ", "+", 
             SuperscriptBox["py", "2"], "+", 
             SuperscriptBox["pz", "2"]}], "]"}]}], ",", 
          RowBox[{"\[Theta]p", "->", 
           RowBox[{"ArcCos", "[", 
            RowBox[{"pz", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["px", "2"], " ", "+", 
               SuperscriptBox["py", "2"], "+", 
               SuperscriptBox["pz", "2"]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\[Phi]p", "->", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"px", ",", "py"}], "]"}]}]}], "}"}]}], ",", " ", "pz"}], 
      "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["px", "2"], "+", 
         SuperscriptBox["py", "2"], "+", 
         SuperscriptBox["pz", "2"]}], "->", 
        SuperscriptBox["p", "2"]}], ",", " ", 
       RowBox[{"Z", "->", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "Ip"}], ")"}], 
         RowBox[{"1", "/", "2"}]]}]}], "}"}]}], ",", " ", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "\[Element]", "Integers"}], "&&", 
        RowBox[{"n", ">", "0"}]}], ",", 
       RowBox[{
        RowBox[{"l", "\[Element]", "Integers"}], "&&", 
        RowBox[{"l", "<", "n"}]}], ",", 
       RowBox[{
        RowBox[{"m", "\[Element]", "Integers"}], "&&", 
        RowBox[{
         RowBox[{"-", "l"}], "<=", "m", "<=", "l"}]}]}], "}"}]}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p", "->", 
     RowBox[{"p", "+", "Az"}]}], ",", 
    RowBox[{"pz", "->", 
     RowBox[{"pz", "+", "Az"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phipAnalytical", "[", 
         RowBox[{"2", ",", "1", ",", "p", ",", "\[Theta]p", ",", "\[Phi]p"}], 
         "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["px", "2"], " ", "+", 
             SuperscriptBox["py", "2"], "+", 
             SuperscriptBox["pz", "2"]}], "]"}]}], ",", 
          RowBox[{"\[Theta]p", "->", 
           RowBox[{"ArcCos", "[", 
            RowBox[{"pz", "/", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["px", "2"], " ", "+", 
               SuperscriptBox["py", "2"], "+", 
               SuperscriptBox["pz", "2"]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"\[Phi]p", "->", 
           RowBox[{"ArcTan", "[", 
            RowBox[{"px", ",", "py"}], "]"}]}]}], "}"}]}], ",", " ", "pz"}], 
      "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["px", "2"], "+", 
         SuperscriptBox["py", "2"], "+", 
         SuperscriptBox["pz", "2"]}], "->", 
        SuperscriptBox["p", "2"]}], ",", " ", 
       RowBox[{"Z", "->", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", "Ip"}], ")"}], 
         RowBox[{"1", "/", "2"}]]}]}], "}"}]}], ",", " ", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "\[Element]", "Integers"}], "&&", 
        RowBox[{"n", ">", "0"}]}], ",", 
       RowBox[{
        RowBox[{"l", "\[Element]", "Integers"}], "&&", 
        RowBox[{"l", "<", "n"}]}], ",", 
       RowBox[{
        RowBox[{"m", "\[Element]", "Integers"}], "&&", 
        RowBox[{
         RowBox[{"-", "l"}], "<=", "m", "<=", "l"}]}]}], "}"}]}]}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"p", "->", 
     RowBox[{"p", "+", "Az"}]}], ",", 
    RowBox[{"pz", "->", 
     RowBox[{"pz", "+", "Az"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.955020634155332*^9, 3.955020728147311*^9}, {
   3.95508167766149*^9, 3.95508174172168*^9}, {3.955081774978772*^9, 
   3.95508182520725*^9}, {3.955081855557187*^9, 3.955081924708602*^9}, 
   3.95508353265322*^9, {3.955083567734831*^9, 3.955083579051757*^9}, {
   3.955083830181391*^9, 3.955083882894341*^9}, {3.955084357915117*^9, 
   3.955084366447863*^9}, {3.955084461289003*^9, 3.955084494815528*^9}, {
   3.955084621760047*^9, 3.955084631174597*^9}, {3.955084664572016*^9, 
   3.9550847128598022`*^9}, 3.955084917587163*^9, 3.95508513149839*^9, 
   3.955085694251771*^9, 3.9550858447830544`*^9, {3.955085923417772*^9, 
   3.955085932592576*^9}, 3.9550859717572937`*^9, 3.9550860066151447`*^9, {
   3.955086383691072*^9, 3.955086424478617*^9}, {3.955086471768392*^9, 
   3.9550864796761923`*^9}, {3.955128313085412*^9, 3.955128315060479*^9}, {
   3.9551950054366217`*^9, 3.955195032211117*^9}, {3.955428190455144*^9, 
   3.9554282005976057`*^9}, {3.955428830775667*^9, 3.955428848648767*^9}, 
   3.9554289028739223`*^9, {3.9554289748076973`*^9, 3.95542900022554*^9}, {
   3.955429090439899*^9, 3.955429103392719*^9}, {3.95542934216736*^9, 
   3.955429343404896*^9}, {3.9554294674056587`*^9, 3.955429479783828*^9}, {
   3.955429514129045*^9, 3.9554295617781277`*^9}, 3.955429608939994*^9, {
   3.955429740870985*^9, 3.955429744476778*^9}, {3.955430618297801*^9, 
   3.955430683614081*^9}, {3.955430732889566*^9, 3.955430734319724*^9}, {
   3.95543082556604*^9, 3.955430830497905*^9}, {3.955430941911909*^9, 
   3.955430984315242*^9}, {3.955431243437591*^9, 3.955431263343622*^9}, 
   3.95543158873129*^9, {3.95543187646226*^9, 3.955431914951948*^9}, {
   3.955431992911825*^9, 3.95543199380048*^9}, {3.955432160388225*^9, 
   3.9554321607600193`*^9}, {3.955432237351398*^9, 3.95543227074362*^9}, {
   3.955432412191296*^9, 3.955432467804872*^9}, {3.9554325126375217`*^9, 
   3.955432627779786*^9}, {3.955432853170824*^9, 3.955432854838694*^9}, {
   3.955432908444393*^9, 3.9554329514141197`*^9}, {3.955433017665938*^9, 
   3.955433018639022*^9}, {3.955433123486485*^9, 3.955433175351007*^9}, {
   3.9554332327629232`*^9, 3.955433255462864*^9}, {3.955433423450387*^9, 
   3.955433426516963*^9}, {3.95543402921421*^9, 3.9554340306269617`*^9}, {
   3.955434159707918*^9, 3.955434178666549*^9}, {3.955434447232091*^9, 
   3.955434458627368*^9}, {3.955435358775987*^9, 3.955435374266984*^9}, {
   3.955441269698349*^9, 3.955441277592969*^9}, {3.955511359201721*^9, 
   3.955511384086511*^9}, 3.955514338780121*^9, {3.955514575860586*^9, 
   3.955514615421193*^9}, {3.955514680725153*^9, 3.955514683673677*^9}, 
   3.955514970893331*^9, {3.955519437399325*^9, 3.955519474186398*^9}, {
   3.955519509843898*^9, 3.955519551558107*^9}, {3.955519642214059*^9, 
   3.955519643871578*^9}, {3.955520187312801*^9, 3.955520204768922*^9}, {
   3.955520803678267*^9, 3.9555208513444853`*^9}, {3.955521239737649*^9, 
   3.955521241172883*^9}, {3.955522796756217*^9, 3.955522807490577*^9}, {
   3.955523150026116*^9, 3.955523157608028*^9}, {3.955523547178213*^9, 
   3.955523556945356*^9}, {3.955524881426323*^9, 3.955524906128205*^9}, {
   3.9555249566351*^9, 3.9555249611045847`*^9}, {3.955524999486197*^9, 
   3.955525001024245*^9}, {3.955530613282003*^9, 3.955530632136284*^9}, {
   3.955536146119383*^9, 3.955536146995012*^9}, {3.955536241653873*^9, 
   3.955536242410486*^9}, {3.955536404139906*^9, 3.955536404248335*^9}, {
   3.955597324110115*^9, 3.9555973386511*^9}, {3.956118613321283*^9, 
   3.956118731269538*^9}, {3.956118830874161*^9, 3.95611890640932*^9}, {
   3.956129018405385*^9, 3.956129122171264*^9}, {3.956208124551804*^9, 
   3.956208125648389*^9}, {3.956302372354197*^9, 3.956302372421356*^9}, {
   3.957163674839896*^9, 3.957163707999674*^9}, {3.9571638261211243`*^9, 
   3.9571638547118196`*^9}, {3.957163901089289*^9, 3.957163908296371*^9}, {
   3.957164041593577*^9, 3.95716404439357*^9}, {3.957180142220729*^9, 
   3.957180153782058*^9}, {3.9571802390262747`*^9, 3.957180242007201*^9}, {
   3.957180302506999*^9, 3.957180323479741*^9}, {3.95724081197301*^9, 
   3.957240829279394*^9}, {3.957242194858399*^9, 3.957242196807021*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"61a05db2-2bc5-4f96-858f-06472f4847a8"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"16", " ", 
    SuperscriptBox["2", 
     RowBox[{"3", "/", "4"}]], " ", 
    SuperscriptBox["Ip", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"Az", "+", "pz"}], ")"}]}], 
   RowBox[{
    SqrtBox[
     SuperscriptBox["Ip", 
      RowBox[{"3", "/", "2"}]]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Ip"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Az", "+", "p"}], ")"}], "2"]}], ")"}], "3"], " ", 
    "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{{3.957181537566491*^9, 3.95718156684991*^9}, {
   3.957240818496504*^9, 3.95724083028202*^9}, 3.9572421978405724`*^9, 
   3.957245527769354*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"0ecfc183-3732-42ad-9ce6-46a92212718f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"16", " ", "\[ImaginaryI]", " ", 
   SuperscriptBox["2", 
    RowBox[{"3", "/", "4"}]], " ", "Ip", " ", 
   SqrtBox[
    SuperscriptBox["Ip", 
     RowBox[{"3", "/", "2"}]]], " ", 
   RowBox[{"(", 
    RowBox[{"Ip", "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Az", "+", "p"}], ")"}], "2"], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Az", "+", "pz"}], ")"}], "2"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"Ip", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Az", "+", "p"}], ")"}], "2"]}]}], ")"}], "4"], " ", 
   "\[Pi]"}]]], "Output",
 CellChangeTimes->{{3.957181537566491*^9, 3.95718156684991*^9}, {
   3.957240818496504*^9, 3.95724083028202*^9}, 3.9572421978405724`*^9, 
   3.957245527859438*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"0889345e-490c-4685-b3e4-940d96f3a74f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phipAnalyticalOld", "[", 
    RowBox[{
    "n_", ",", "l_", ",", "m_", ",", "p_", ",", "\[Theta]p_", ",", 
     "\[Phi]p_"}], "]"}], " ", ":=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["2", "n"], ")"}], "3"], 
      FractionBox[
       RowBox[{"Factorial", "[", 
        RowBox[{"(", 
         RowBox[{"n", "-", "l", "-", "1"}], ")"}], "]"}], 
       RowBox[{"n", "*", 
        RowBox[{"Factorial", "[", 
         RowBox[{"(", 
          RowBox[{"n", "+", "l"}], ")"}], "]"}]}]]}]], "*", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "n"], ")"}], 
     RowBox[{
      RowBox[{"-", "3"}], "-", 
      RowBox[{"2", "*", "l"}]}]], "*", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "n"], ")"}], "l"], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["I", "l"], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "\[Iota]"], "*", 
       FractionBox[
        SuperscriptBox["2", "\[Iota]"], 
        RowBox[{"Factorial", "[", "\[Iota]", "]"}]], "*", 
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{"n", "+", "l"}], ",", 
         RowBox[{"n", "-", "l", "-", "1", "-", "\[Iota]"}]}], "]"}], "*", 
       SuperscriptBox["p", "l"], "*", 
       RowBox[{"Gamma", "[", 
        RowBox[{"3", "+", 
         RowBox[{"2", "*", "l"}], "+", "\[Iota]"}], "]"}], "*", 
       RowBox[{"Hypergeometric2F1Regularized", "[", 
        RowBox[{
         RowBox[{"2", "+", "l", "+", 
          FractionBox["\[Iota]", "2"]}], ",", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"2", " ", "l"}], "+", "\[Iota]"}], ")"}]}], ",", 
         RowBox[{
          FractionBox["3", "2"], "+", "l"}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["n", "2"]}], " ", 
           SuperscriptBox["p", "2"]}], 
          SuperscriptBox["Z", "2"]]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Iota]", ",", "0", ",", 
        RowBox[{"n", "-", "l", "-", "1"}]}], "}"}]}], "]"}], "*", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"l", ",", "m", ",", "\[Theta]p", ",", "\[Phi]p"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"phipAnalyticalOld", "[", 
       RowBox[{
       "2", ",", "0", ",", "0", ",", "p", ",", "\[Theta]", ",", "\[Phi]"}], 
       "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "->", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           SuperscriptBox["px", "2"], " ", "+", 
           SuperscriptBox["py", "2"], "+", 
           SuperscriptBox["pz", "2"]}], "]"}]}], ",", 
        RowBox[{"\[Theta]", "->", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"pz", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox["px", "2"], " ", "+", 
             SuperscriptBox["py", "2"], "+", 
             SuperscriptBox["pz", "2"]}], "]"}]}], "]"}]}], ",", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"px", ",", "py"}], "]"}]}]}], "}"}]}], ",", " ", "pz"}], 
    "]"}], "]"}], "//.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["px", "2"], "+", 
      SuperscriptBox["py", "2"], "+", 
      SuperscriptBox["pz", "2"]}], "->", 
     SuperscriptBox["p", "2"]}], ",", " ", 
    RowBox[{"Z", " ", "->", " ", "1"}]}], "}"}]}]}], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"df1666d6-7de6-415b-af7b-421760969d1c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"512", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["p", "2"]}]}], ")"}], " ", "pz"}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["p", "2"]}]}], ")"}], "4"], " ", "\[Pi]"}]]], "Output",
 CellChangeTimes->{3.955128296971018*^9},
 CellLabel->
  "Out[179]=",ExpressionUUID->"c9221eaa-1ed0-4bd0-9de7-84ec433d530d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ResourceFunction", "[", "\"\<HydrogenWavefunction\>\"", "]"}], "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"aade1554-0ea9-437f-94cf-4dcdb405be2d"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", "r"}]], 
  SqrtBox["\[Pi]"]]], "Output",
 CellChangeTimes->{3.9563022294951363`*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"3b99821e-0fd1-4496-a981-378dde75ba60"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"16", " ", 
        SuperscriptBox["2", 
         RowBox[{"3", "/", "4"}]], " ", 
        SuperscriptBox["Ip", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"Az", "+", "pz"}], ")"}]}], 
       RowBox[{
        SqrtBox[
         SuperscriptBox["Ip", 
          RowBox[{"3", "/", "2"}]]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Ip"}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Az", "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["px", "2"], "+", 
                 SuperscriptBox["py", "2"], "+", 
                 SuperscriptBox["pz", "2"]}], ")"}], 
               RowBox[{"1", "/", "2"}]]}], ")"}], "2"]}], ")"}], "3"], " ", 
        "\[Pi]"}]]}], ")"}], "2"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"px", ",", " ", "0", ",", " ", "\[Infinity]"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"py", ",", " ", "0", ",", " ", "\[Infinity]"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"pz", ",", " ", "0", ",", " ", "\[Infinity]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9563022334470453`*^9, 3.956302235838559*^9}, {
  3.956302384177073*^9, 3.956302423667729*^9}, {3.956302454470806*^9, 
  3.956302508608076*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ad3f44a7-64a8-4827-bdc1-8d46b3de89e0"],

Cell[BoxData[
 FractionBox[
  RowBox[{"512", " ", 
   SqrtBox["2"], " ", 
   SuperscriptBox["Ip", 
    RowBox[{"5", "/", "2"}]], " ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
      RowBox[{
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Az", "+", "pz"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Ip"}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Az", "+", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["px", "2"], "+", 
                SuperscriptBox["py", "2"], "+", 
                SuperscriptBox["pz", "2"]}]]}], ")"}], "2"]}], ")"}], "6"]], 
       RowBox[{"\[DifferentialD]", "pz"}], 
       RowBox[{"\[DifferentialD]", "py"}], 
       RowBox[{"\[DifferentialD]", "px"}]}]}]}]}]}], 
  SuperscriptBox["\[Pi]", "2"]]], "Output",
 CellChangeTimes->{3.956302425384323*^9, 3.95630248136195*^9, 
  3.956302620033287*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"8907085d-9274-41c5-9415-a6f39d12410a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
     "]"}], "*", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "*", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"lp", ",", "mp", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
    "*", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
     RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"Element", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l", ",", "lp"}], "}"}], ",", "Integers"}], "]"}], "&&", 
     RowBox[{"l", ">=", "0"}], "&&", 
     RowBox[{"Element", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "mp"}], "}"}], ",", "Integers"}], "]"}]}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.957512349250842*^9, 3.957512362174408*^9}, 
   3.957512451125407*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"99339db6-7ca1-4de2-8926-65715f4fcdd0"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{"SphericalHarmonicY", "[", 
      RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}], 
     "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"SphericalHarmonicY", "[", 
     RowBox[{"lp", ",", "mp", ",", "\[Theta]", ",", "\[CurlyPhi]"}], "]"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[CurlyPhi]", ",", "0", ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"l", "|", "lp"}], ")"}], "\[Element]", 
      TemplateBox[{},
       "Integers"]}], "&&", 
     RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "|", "mp"}], ")"}], "\[Element]", 
      TemplateBox[{},
       "Integers"]}]}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.957512364928656*^9, 3.9575124477444143`*^9, 
  3.957512592316145*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"046ed502-1f5a-48a0-8351-ea010b3d0c75"]
}, Open  ]]
},
WindowSize->{1387.5, 762},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b6444691-887c-4b87-9146-5286d864d403"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 416, 9, 134, "Text",ExpressionUUID->"5b62773b-5fb4-4107-9dc0-ec3b8108cdfd"],
Cell[CellGroupData[{
Cell[999, 33, 3983, 103, 130, "Input",ExpressionUUID->"b465ff2b-6010-2a49-a903-d73b3d86ad12"],
Cell[4985, 138, 1015, 19, 59, "Output",ExpressionUUID->"32bd984e-2717-4e08-ac24-afd384eb482f"],
Cell[6003, 159, 1081, 20, 59, "Output",ExpressionUUID->"a7708a11-5b81-43fe-ab5a-2e19d4c48633"],
Cell[7087, 181, 19665, 528, 714, "Output",ExpressionUUID->"36d6db6b-9db3-44c9-8c9f-f14f169112f4"]
}, Open  ]],
Cell[26767, 712, 494, 15, 79, "Text",ExpressionUUID->"8cbcfe88-1969-4492-936a-fd3e791ecb3b"],
Cell[CellGroupData[{
Cell[27286, 731, 4610, 107, 146, "Input",ExpressionUUID->"777a70d3-f19f-4eb2-8ffc-0a2e5f7c48e0"],
Cell[31899, 840, 3845, 89, 119, "Output",ExpressionUUID->"812755c5-a52c-4df6-b47f-2d8a97a77cb5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35781, 934, 11053, 257, 208, "Input",ExpressionUUID->"61a05db2-2bc5-4f96-858f-06472f4847a8"],
Cell[46837, 1193, 795, 24, 60, "Output",ExpressionUUID->"0ecfc183-3732-42ad-9ce6-46a92212718f"],
Cell[47635, 1219, 1056, 32, 62, "Output",ExpressionUUID->"0889345e-490c-4685-b3e4-940d96f3a74f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48728, 1256, 3765, 111, 189, "Input",ExpressionUUID->"df1666d6-7de6-415b-af7b-421760969d1c"],
Cell[52496, 1369, 471, 15, 61, "Output",ExpressionUUID->"c9221eaa-1ed0-4bd0-9de7-84ec433d530d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53004, 1389, 365, 8, 29, "Input",ExpressionUUID->"aade1554-0ea9-437f-94cf-4dcdb405be2d"],
Cell[53372, 1399, 243, 6, 52, "Output",ExpressionUUID->"3b99821e-0fd1-4496-a981-378dde75ba60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53652, 1410, 1536, 42, 60, "Input",ExpressionUUID->"ad3f44a7-64a8-4827-bdc1-8d46b3de89e0"],
Cell[55191, 1454, 1256, 35, 66, "Output",ExpressionUUID->"8907085d-9274-41c5-9415-a6f39d12410a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56484, 1494, 1193, 32, 54, "Input",ExpressionUUID->"99339db6-7ca1-4de2-8926-65715f4fcdd0"],
Cell[57680, 1528, 1213, 33, 35, "Output",ExpressionUUID->"046ed502-1f5a-48a0-8351-ea010b3d0c75"]
}, Open  ]]
}
]
*)

